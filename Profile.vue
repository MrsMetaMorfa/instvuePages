<template lang="pug">
.profile
  ModalDataFilter(v-if="dataFilterActive", :date_range="this.statistics.date_range", @closeModal="filterDateRange")
  .profile_avatar
    .loading.loading-page(v-if="loadingUserData")
    .wrapper
      img(:src="this.$store.state.user.is_linked_instagram ? this.$store.state.user.instagram.avatar : ''", alt="avatar", @click="changeUserProfile")
      h2.profile_nickname {{ this.$store.state.user.is_linked_instagram ? '@' + this.$store.state.user.instagram.username : 'not_linked' }}
  .wrapper
    .profile_message


      h2.profile_title Ваше обращение:
      .card.container.message(@click="messageEdit")
        p(id="appealMessage", contenteditable=false) {{ this.$store.state.user.appeal_message || ' ' }}
        button.btn.btn-reverse(id="messageEdit", type="button", title='Изменить', @click="messageEdit")
          svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
            path(d="M506.14,122.982L389.517,6.36c-7.803-7.804-20.453-7.815-28.269-0.023L50.863,315.722c-2.449,2.441-4.223,5.475-5.149,8.805L0.733,486.13c-1.94,6.97,0.035,14.445,5.164,19.548c3.801,3.781,8.895,5.823,14.11,5.823c1.823,0,3.662-0.25,5.465-0.762l161.603-45.904c6.819-1.937,12.104-7.337,13.892-14.196s-0.186-14.152-5.19-19.172l-42.455-42.584l224.47-224.47l29.078,29.078L237.864,361.377c-7.838,7.787-7.88,20.454-0.094,28.292c7.785,7.838,20.452,7.88,28.292,0.094l240.031-238.441c3.772-3.748,5.898-8.843,5.907-14.16C512.009,131.844,509.9,126.742,506.14,122.982z M48.841,462.506l26.492-95.179l68.103,68.31L48.841,462.506z M125.073,360.547l-31.154-31.248l224.743-224.019l30.839,30.839L125.073,360.547z M435.257,165.291l-88.257-88.257l28.349-28.258l88.305,88.306L435.257,165.291z")
        button.btn.btn-default.hidden(type="button", title="Сохранить", @click="messageSave")
          svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
            path(d="M504.527,67.909c-8.611-6.92-21.2-5.547-28.118,3.063L210.291,402.169c-3.612,3.863-8.494,6.101-13.797,6.314c-5.459,0.22-10.629-1.73-14.523-5.431L33.839,261.061c-7.975-7.643-20.634-7.374-28.278,0.599c-7.643,7.974-7.375,20.634,0.599,28.278l148.191,142.048c11.26,10.703,25.83,16.515,41.268,16.515c0.825,0,1.655-0.017,2.484-0.051c16.352-0.657,31.371-7.734,42.288-19.926c0.237-0.265,0.467-0.537,0.691-0.814L507.59,96.027C514.508,87.416,513.137,74.828,504.527,67.909z")

      .tutorial_helper(v-if="showTutorialHelper(3)")
        p На последнем этапе ротации <span>можно задать вопрос</span> пользователю, который выбрал вас среди других участников ротации. Например, можно спросить что он думает про ваше описание или стилистику профиля.
        button.later(@click="nextStage" class="btn btn-default") Заполнить позже


    .card.container.profile_referrals
      p <span>0</span> Рефералов
      button.btn.btn-default(type="button", title="")
        svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
          path(d="M234.071,471.132H60.391c-6.453,0-12.333-2.991-16.135-8.207c-3.803-5.218-4.85-11.736-2.874-17.883c19.732-61.346,79.908-104.191,146.336-104.191c30.909,0,60.591,9.308,85.838,26.916c9.043,6.307,21.485,4.09,27.795-4.953c6.306-9.043,4.089-21.486-4.954-27.794c-12.498-8.717-25.85-15.828-39.817-21.257c18.583-16.896,30.911-40.555,33.053-67.048c28.177-27.448,65.111-42.488,104.704-42.488c30.909,0,60.591,9.308,85.838,26.916c9.043,6.307,21.486,4.09,27.795-4.953c6.306-9.043,4.089-21.486-4.954-27.794c-12.498-8.717-25.85-15.828-39.817-21.257c20.499-18.638,33.386-45.506,33.386-75.328C496.586,45.673,450.913,0,394.774,0c-56.14,0-101.812,45.673-101.812,101.813c0,29.701,12.784,56.473,33.139,75.102c-2.785,1.072-5.55,2.212-8.295,3.42c-12.492,5.497-24.241,12.245-35.162,20.183c-15.068-37.415-51.746-63.893-94.49-63.893c-56.14,0-101.812,45.673-101.812,101.813c0,29.614,12.71,56.316,32.96,74.938c-54.148,20.292-98.053,63.87-115.927,119.444c-5.928,18.431-2.788,37.976,8.616,53.623c11.402,15.645,29.042,24.618,48.401,24.618h173.68c11.026,0,19.963-8.938,19.963-19.963S245.096,471.132,234.071,471.132z M394.775,39.926c34.124,0,61.886,27.762,61.886,61.886s-27.762,61.886-61.886,61.886c-34.124,0-61.886-27.762-61.886-61.886S360.651,39.926,394.775,39.926z M188.155,176.55c34.124,0,61.886,27.762,61.886,61.886s-27.762,61.886-61.886,61.886s-61.886-27.762-61.886-61.886S154.031,176.55,188.155,176.55z")
          path(d="M503.217,326.082c-8.965-6.418-21.436-4.354-27.853,4.612l-98.4,137.447c-2.687,3.116-6.055,3.789-7.859,3.909c-1.857,0.127-5.463-0.114-8.555-3.057l-63.703-61.168c-7.954-7.638-20.593-7.379-28.226,0.573c-7.637,7.952-7.38,20.59,0.572,28.226l63.767,61.228c9.55,9.091,22.298,14.149,35.414,14.149c1.127,0,2.257-0.037,3.387-0.113c14.288-0.952,27.628-7.9,36.599-19.062c0.233-0.289,0.455-0.584,0.672-0.885l98.799-138.006C514.247,344.97,512.183,332.5,503.217,326.082z")
    .profile_energy
      h2.profile_title Баланс энергии
      .card.energy
        p.container.energy_personal
          span.title Личный баланс
          span.energy
            svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
              path(d="M435.243,193.711c-7.943-17.294-24.785-28.037-43.952-28.037H323.08l80.803-135.489c3.68-6.168,3.761-13.837,0.214-20.081C400.549,3.858,393.921,0,386.739,0H197.113c-7.519,0-14.402,4.226-17.802,10.933L79.966,206.826c-11.117,21.828-10.111,47.329,2.69,68.214c12.803,20.885,35.069,33.353,59.565,33.353h69.865l-69.475,142.542c-9.287,18.852-3.868,40.604,13.176,52.896c7.592,5.475,16.234,8.17,24.809,8.169c10.676,0,21.247-4.178,29.542-12.365c0.362-0.358,0.712-0.73,1.045-1.114l154.695-178.034c7.231-8.322,6.346-20.929-1.975-28.16c-8.324-7.232-20.931-6.347-28.16,1.975L181.667,471.625c-0.598,0.508-1.26,0.742-2.528-0.173c-1.573-1.135-1.176-1.941-0.679-2.95l83.504-171.325c3.014-6.186,2.63-13.49-1.017-19.325c-3.648-5.836-10.044-9.381-16.927-9.381h-101.8c-10.655,0-19.959-5.21-25.527-14.295c-5.568-9.084-5.989-19.74-1.139-29.265l93.815-184.99h142.223L270.79,175.411c-3.68,6.168-3.761,13.837-0.214,20.081s10.175,10.103,17.357,10.103h103.357c4.769,0,6.856,2.994,7.676,4.779c0.839,1.826,1.771,5.447-1.419,9.162c-7.183,8.364-6.226,20.966,2.137,28.149c8.365,7.182,20.967,6.227,28.148-2.137C440.379,230.937,443.219,211.074,435.243,193.711z")
            | {{ Math.floor(this.$store.state.user.activity_points / 100) }} Энергии
        p.container.energy_partnership
          span.title Баланс партнерки
          span.energy
            svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
              path(d="M435.243,193.711c-7.943-17.294-24.785-28.037-43.952-28.037H323.08l80.803-135.489c3.68-6.168,3.761-13.837,0.214-20.081C400.549,3.858,393.921,0,386.739,0H197.113c-7.519,0-14.402,4.226-17.802,10.933L79.966,206.826c-11.117,21.828-10.111,47.329,2.69,68.214c12.803,20.885,35.069,33.353,59.565,33.353h69.865l-69.475,142.542c-9.287,18.852-3.868,40.604,13.176,52.896c7.592,5.475,16.234,8.17,24.809,8.169c10.676,0,21.247-4.178,29.542-12.365c0.362-0.358,0.712-0.73,1.045-1.114l154.695-178.034c7.231-8.322,6.346-20.929-1.975-28.16c-8.324-7.232-20.931-6.347-28.16,1.975L181.667,471.625c-0.598,0.508-1.26,0.742-2.528-0.173c-1.573-1.135-1.176-1.941-0.679-2.95l83.504-171.325c3.014-6.186,2.63-13.49-1.017-19.325c-3.648-5.836-10.044-9.381-16.927-9.381h-101.8c-10.655,0-19.959-5.21-25.527-14.295c-5.568-9.084-5.989-19.74-1.139-29.265l93.815-184.99h142.223L270.79,175.411c-3.68,6.168-3.761,13.837-0.214,20.081s10.175,10.103,17.357,10.103h103.357c4.769,0,6.856,2.994,7.676,4.779c0.839,1.826,1.771,5.447-1.419,9.162c-7.183,8.364-6.226,20.966,2.137,28.149c8.365,7.182,20.967,6.227,28.148-2.137C440.379,230.937,443.219,211.074,435.243,193.711z")
            | {{ this.$store.state.user.ref_activity_points / 100 }} Энергии
          button.btn(type="button", @click="clickExchangeButton")
            span

    .tutorial_helper(v-if="showTutorialHelper(6)")
      button.later(@click="nextStage" class="btn btn-default") Энергия – для чего она?

    .profile_shows
      h2.profile_title Доступно показов

      .tutorial_helper(v-if="showTutorialHelper(7)")
        p За энергию можно <span>покупать показы</span>. Сейчас на сервисе доступна только ротация, но скоро тут появятся новые разделы.<br> Купите немного показов в ротации
        button.later(@click="nextStage" class="btn btn-default") Куплю позже

      .shows.container
        button.btn.card.shows_posts(v-for="section in sections", type="button", :data-code="section.code", @click="addMoreShows")
          h3.shows_title {{ section.title }}
          svg(xmlns="http://www.w3.org/2000/svg", :viewBox="section.viewBox", v-html="section.path")
          p.shows_number.container
            svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
              circle(cx="257.013", cy="256.003", r="38.999")
              path(d="M257.011,142.002c-62.858,0-113.997,51.139-113.997,113.997s51.139,113.997,113.997,113.997s113.997-51.139,113.997-113.997S319.869,142.002,257.011,142.002z M257.011,329.997c-40.803,0-73.998-33.195-73.998-73.998c0-40.803,33.195-73.998,73.998-73.998s73.998,33.195,73.998,73.998C331.009,296.802,297.814,329.997,257.011,329.997z")
              path(d="M499.046,212.345c-10.618-16.306-40.581-58.167-89.352-94.633c-49.438-36.965-100.997-55.709-153.246-55.709c-52.175,0-103.779,18.693-153.379,55.558c-48.988,36.41-79.191,78.219-89.903,94.504c-17.555,26.689-17.555,61.178,0,87.867c10.712,16.286,40.915,58.095,89.903,94.505c49.6,36.865,101.203,55.558,153.379,55.558c80.325,0,144.917-44.788,184.957-82.359c8.055-7.558,8.458-20.214,0.9-28.269c-7.559-8.056-20.214-8.458-28.269-0.9c-34.777,32.632-90.347,71.53-157.59,71.53c-97.104,0-177.606-83.001-209.865-132.045c-8.772-13.336-8.772-30.568,0-43.904c32.259-49.044,112.761-132.044,209.865-132.044c97.101,0,177.112,83.08,209.081,132.17c8.635,13.259,8.635,30.393,0,43.652c-6.027,9.256-3.41,21.645,5.846,27.673c9.255,6.027,21.646,3.411,27.673-5.846C516.315,273.134,516.315,238.863,499.046,212.345z")
            span {{ $store.state.user.is_linked_instagram ? $store.state.user.shows[ section.code ] : '-' }} пок.



    .tutorial_helper(v-if="showTutorialHelper(8)")
      p Чтобы <span>отслеживать эффективность</span> вашего профиля можно посмотреть раздел «<span>Статистика</span>». Чуть позже вы сможете изучить этот раздел более подробно в отдельном обучении.
      button.later(@click="nextStage" class="btn btn-default") Далее


    .tutorial_helper(v-if="showTutorialHelper(9)")
      p Во вкладке «<span>Обратная связь</span>» находятся <span>ответы</span> на ваш вопрос и <span>рекомендации по улучшению профиля</span>
      button.later(@click="nextStep" class="btn btn-default") Далее


    .profile_tabs
      .card.container.tabs
        button.btn(:class='{active: buttonStatisticActive}' type="button", @click="setStatisticActive") Статистика
        button.btn(:class='{active: buttonFeedbackActive}' type="button", @click="setFeedbackActive") Обратная связь
        button.btn(:class='{active: buttonPartnershipActive}' type="button", @click="setPartnershipActive") Партнерка
      .tabs_content
        transition(name="fade", mode="out-in")
          .tab_statistic(v-if="tabStatisticActive")
            .container.statistic_filters
              .filters_buttons.container
                button.btn.active(type="button", @click="setActiveTimeFilter($event,0)") Сегодня
                button.btn(type="button", @click="setActiveTimeFilter($event,7)") Неделя
                button.btn(type="button", @click="setActiveTimeFilter($event,30)") Месяц
              .filter_icons.container
                button.btn(type="button", @click="switchChute", :class="statistics.chute_type ? '' : 'active'")
                  svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                    path(d="M492,0.103H20c-11.046,0-20,8.954-20,20c0,77.49,22.928,145.332,72.155,213.502c30.712,42.531,85.808,73.844,113.845,87.866v121.426c0,7.633,4.346,14.601,11.2,17.96l100,49c2.784,1.364,5.795,2.04,8.799,2.04c3.684,0,7.357-1.017,10.584-3.029C322.44,505.215,326,498.8,326,491.897v-82.425c0-11.046-8.954-20-20-20c-11.046,0-20,8.954-20,20v50.353l-60-29.4V308.897c0-7.813-4.55-14.911-11.65-18.173c-37.338-17.156-85.782-47.322-109.766-80.536C64.849,155.163,44.258,100.64,40.597,40.103h430.806c-3.661,60.536-24.252,115.06-63.987,170.085c-25.348,35.103-73.046,65.879-109.072,80.807c-10.204,4.229-15.049,15.928-10.82,26.133c4.228,10.204,15.927,15.049,26.133,10.82c38.221-15.838,94.204-50.049,126.188-94.343C489.072,165.435,512,97.593,512,20.103C512,9.057,503.046,0.103,492,0.103z")
                button.btn(type="button", @click="dataFilterActive = true")
                  svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                    path(d="M196.5,406.122c-11.046,0-20,8.954-20,20V492c0,11.046,8.954,20,20,20s20-8.954,20-20v-65.878C216.5,415.076,207.546,406.122,196.5,406.122z")
                    path(d="M236.5,326h-20V20c0-11.046-8.954-20-20-20s-20,8.954-20,20v306h-20c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h80c11.046,0,20-8.954,20-20C256.5,334.954,247.546,326,236.5,326z")
                    path(d="M60.5,144.122c-11.046,0-20,8.954-20,20V492c0,11.046,8.954,20,20,20s20-8.954,20-20V164.122C80.5,153.076,71.546,144.122,60.5,144.122z")
                    path(d="M100.5,64.244h-20V20c0-11.046-8.954-20-20-20s-20,8.954-20,20v44.244h-20c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h80c11.046,0,20-8.954,20-20C120.5,73.198,111.546,64.244,100.5,64.244z")
                    path(d="M451.5,171.168c-11.046,0-20,8.954-20,20V492c0,11.046,8.954,20,20,20c11.046,0,20-8.954,20-20V191.168C471.5,180.122,462.546,171.168,451.5,171.168z")
                    path(d="M491.5,91.122h-20V20c0-11.046-8.954-20-20-20c-11.046,0-20,8.954-20,20v71.122h-20c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h80c11.046,0,20-8.954,20-20S502.546,91.122,491.5,91.122z")
                    path(d="M321.5,318.122c-11.046,0-20,8.954-20,20V492c0,11.046,8.954,20,20,20c11.046,0,20-8.954,20-20V338.122C341.5,327.076,332.546,318.122,321.5,318.122z")
                    path(d="M361.5,238.244h-20V20c0-11.046-8.954-20-20-20c-11.046,0-20,8.954-20,20v218.244h-20c-11.046,0-20,8.954-20,20s8.954,20,20,20h80c11.046,0,20-8.954,20-20C381.5,247.198,372.546,238.244,361.5,238.244z")
            .container.statistic_sorting
              p Статистка по выбранному разделу:
              .sorting_list
                button.btn(type="button", aria-label='Сортировать по', @click="openSorting") {{ statistics_sort_title }}
                  img(src="/images/icons/arrow-down.svg", alt="")
                ul
                  li(v-for="section in sections")
                    button.btn(type="button", aria-label='Сортировать по', :data-code="section.code", @click="setSortingType") {{ section.title }}

            .card.statistic_info(v-if="statistics.selected_code")
              .info_line(v-for="line in statistics[ statistics.selected_code ].lines")
                p.container
                  span.title {{ line.title }}:
                  span.number {{ line.value }}
                p.container(:class="'color_' + line.color()")
                  span.progress
                    span.progress-bar(:style="'width: ' + line.percent(line, 'style') + '%'")
                  span.percent {{ line.percent(line, 'value') }}%

            .card.statistic_info(v-if="!statistics.selected_code")
              .info_line
                p.container.loading &nbsp;

          .tab_feedback(v-if="tabFeedbackActive")
            .container.feedback_filters
              .filters_buttons.container
                button.btn(type="button", :class="{active: feedbackTips}" @click="openFeedbackTips") Советы
                button.btn(type="button", :class="{active: feedbackAnswers}" @click="openFeedbackAnswers") Ответы
              .filter_buttons.container
                p Сортировка:
                button.btn(type="button", @click="setFeedbackSort('likes')" :class="feedbackSortType === 'likes' ? 'active' : ''")
                  svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                    path(d="M452,188h-30c-6.513,0-12.786,1.043-18.663,2.971l-98.74-153.753l-12.888-18.104L290.616,18C279.239,6.392,264.022,0,247.769,0c-33.084,0-60,26.916-60,60c0,6.667,1.092,13.226,3.244,19.495l0.409,1.192l0.557,1.132c3.142,6.395,6.5,13.081,10.055,20.158c8.963,17.845,23.761,47.306,25.978,56.162C226.569,168.62,212.556,175,202.574,175H71c-31.43,0-57,25.57-57,57c0,10.347,2.83,20.344,7.982,29.021C8.429,271.569,0,287.974,0,306c0,14.156,5.172,27.793,14.563,38.398c2.471,2.791,5.164,5.293,8.038,7.487c-4.851,8.455-7.535,18.124-7.535,28.115c0,21.677,12.255,40.567,30.247,50.204C41.87,437.408,40,445.313,40,453.429C40,487.367,64.062,512,97.214,512H293c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H97.214C81.678,472,80,459.013,80,453.429c0-8.252,6.97-12.739,9.105-13.917c11.22-6.189,12.895-15.081,12.895-19.83C102,406.963,91.019,397,77,397h-4.511c-9.607,0-17.423-7.626-17.423-17c0-5.966,3.324-11.587,8.674-14.668c0.339-0.195,0.654-0.363,0.94-0.517c8.839-4.774,13.32-11.634,13.32-20.39c0-7.547-5.038-20.593-23.92-21.612C46.448,322.4,40,314.701,40,306c0-7.672,5.422-14.609,12.892-16.493C64.919,286.473,73,277.026,73,266c0-5.459-2.013-13.362-11.6-20.014C56.767,242.771,54,237.543,54,232c0-9.374,7.626-17,17-17h131.574c30.471,0,64.185-21.643,65.519-56.607l0.015-0.763c0-12.025-8.777-30.697-30.33-73.606c-3.267-6.504-6.365-12.672-9.246-18.519c-0.507-1.777-0.763-3.624-0.763-5.505c0-11.028,8.972-20,20-20c4.982,0,9.673,1.802,13.345,5.101l10.091,14.143l100.364,156.281C365.516,224.891,362,236.043,362,248v204c0,33.084,26.916,60,60,60h30c33.084,0,60-26.916,60-60V248C512,214.916,485.084,188,452,188z M472,452c0,11.028-8.972,20-20,20h-30c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V452z")
                button.btn(type="button", @click="setFeedbackSort('time')" :class="feedbackSortType === 'time' ? 'active' : ''")
                  svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                    path(d="M437.02,74.98C388.667,26.629,324.38,0,256,0S123.333,26.629,74.98,74.98C26.629,123.333,0,187.62,0,256s26.629,132.667,74.98,181.02C123.333,485.371,187.62,512,256,512c46.813,0,92.617-12.757,132.461-36.893c9.448-5.723,12.468-18.021,6.745-27.468c-5.722-9.449-18.022-12.468-27.468-6.745C334.143,461.244,295.505,472,256,472c-119.103,0-216-96.897-216-216S136.897,40,256,40s216,96.897,216,216c0,42.589-12.665,84.044-36.627,119.885c-6.139,9.182-3.672,21.603,5.511,27.742c9.183,6.139,21.603,3.671,27.742-5.511C497.001,355.674,512,306.531,512,256C512,187.62,485.371,123.333,437.02,74.98z")
                    path(d="M256,76c-11.046,0-20,8.954-20,20v151.716l-73.338,73.338c-7.811,7.81-7.811,20.473,0,28.284c3.905,3.905,9.023,5.858,14.142,5.858s10.237-1.953,14.142-5.858l79.196-79.196c3.751-3.75,5.858-8.838,5.858-14.142V96C276,84.954,267.046,76,256,76z")
            .container.feedback_filters
              p Выбрано: <span>{{ feedbackTips ? recommendations.filter(e => e.selected).length : answers.list.filter(e => e.selected).length }}</span>
              .sorting_list
                button.btn(type="button", @click="selectAllFeedback") Выбрать все
                button.btn(type="button", @click="deleteSelected")
                  svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                    path(d="M472,83H351V60c0-33.084-26.916-60-60-60h-70c-33.084,0-60,26.916-60,60v23H40c-11.046,0-20,8.954-20,20s8.954,20,20,20h20.712l24.374,315.987c0.007,0.092,0.015,0.185,0.023,0.278c1.816,19.924,10.954,38.326,25.73,51.816C125.615,504.571,144.771,512,164.778,512h182.444c41.667,0,75.917-31.032,79.669-72.183c1.003-11.001-7.101-20.731-18.101-21.734c-11.011-1.003-20.731,7.101-21.734,18.101C385.195,456.603,368.07,472,347.222,472H164.778c-20.777,0-37.875-15.571-39.823-36.242L100.831,123h310.338l-17.082,221.462c-0.849,11.013,7.39,20.629,18.403,21.479c0.524,0.04,1.043,0.06,1.56,0.06c10.347,0,19.11-7.974,19.919-18.463L451.288,123H472c11.046,0,20-8.954,20-20S483.046,83,472,83z M311,83H201V60c0-11.028,8.972-20,20-20h70c11.028,0,20,8.972,20,20V83z")
                    path(d="M165.127,163.019c-11.035,0.482-19.59,9.818-19.108,20.854l10,228.933c0.469,10.738,9.322,19.128,19.966,19.128c0.294,0,0.591-0.006,0.888-0.02c11.035-0.482,19.59-9.818,19.108-20.854l-10-228.934C185.499,171.092,176.145,162.523,165.127,163.019z")
                    path(d="M326.019,182.127l-10,228.934c-0.482,11.035,8.073,20.372,19.108,20.854c0.297,0.013,0.593,0.02,0.888,0.02c10.643,0,19.497-8.39,19.966-19.128l10-228.933c0.482-11.035-8.073-20.372-19.108-20.854C335.856,162.527,326.501,171.092,326.019,182.127z")
                    path(d="M236,183v228.933c0,11.046,8.954,20,20,20c11.046,0,20-8.954,20-20V183c0-11.046-8.954-20-20-20S236,171.954,236,183z")
            transition(name="fade", mode="out-in")
              .feedback_list(v-if="feedbackTips")
                ul.answer_list

                  li.card.container(v-for="recommendation in recommendations" @click="switchFeedbackSelection(recommendation.id, 'recommendations')" :class="recommendation.selected ? 'selected' : ''")
                    img(:src="recommendation.from.avatar", alt="Avatar")
                    .answer
                      p.usefull.container Полезность пользователя:
                        span.good.container
                          svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                            path(d="M452,188h-30c-6.513,0-12.786,1.043-18.663,2.971l-98.74-153.753l-12.888-18.104L290.616,18C279.239,6.392,264.022,0,247.769,0c-33.084,0-60,26.916-60,60c0,6.667,1.092,13.226,3.244,19.495l0.409,1.192l0.557,1.132c3.142,6.395,6.5,13.081,10.055,20.158c8.963,17.845,23.761,47.306,25.978,56.162C226.569,168.62,212.556,175,202.574,175H71c-31.43,0-57,25.57-57,57c0,10.347,2.83,20.344,7.982,29.021C8.429,271.569,0,287.974,0,306c0,14.156,5.172,27.793,14.563,38.398c2.471,2.791,5.164,5.293,8.038,7.487c-4.851,8.455-7.535,18.124-7.535,28.115c0,21.677,12.255,40.567,30.247,50.204C41.87,437.408,40,445.313,40,453.429C40,487.367,64.062,512,97.214,512H293c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H97.214C81.678,472,80,459.013,80,453.429c0-8.252,6.97-12.739,9.105-13.917c11.22-6.189,12.895-15.081,12.895-19.83C102,406.963,91.019,397,77,397h-4.511c-9.607,0-17.423-7.626-17.423-17c0-5.966,3.324-11.587,8.674-14.668c0.339-0.195,0.654-0.363,0.94-0.517c8.839-4.774,13.32-11.634,13.32-20.39c0-7.547-5.038-20.593-23.92-21.612C46.448,322.4,40,314.701,40,306c0-7.672,5.422-14.609,12.892-16.493C64.919,286.473,73,277.026,73,266c0-5.459-2.013-13.362-11.6-20.014C56.767,242.771,54,237.543,54,232c0-9.374,7.626-17,17-17h131.574c30.471,0,64.185-21.643,65.519-56.607l0.015-0.763c0-12.025-8.777-30.697-30.33-73.606c-3.267-6.504-6.365-12.672-9.246-18.519c-0.507-1.777-0.763-3.624-0.763-5.505c0-11.028,8.972-20,20-20c4.982,0,9.673,1.802,13.345,5.101l10.091,14.143l100.364,156.281C365.516,224.891,362,236.043,362,248v204c0,33.084,26.916,60,60,60h30c33.084,0,60-26.916,60-60V248C512,214.916,485.084,188,452,188z M472,452c0,11.028-8.972,20-20,20h-30c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V452z")
                          | {{ recommendation.from.upvotes }}
                        | /
                        span.bad.container
                          svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                            path(d="M512,206c0-14.156-5.172-27.793-14.563-38.398c-2.471-2.791-5.164-5.293-8.038-7.487c4.851-8.455,7.535-18.124,7.535-28.115c0-21.677-12.255-40.567-30.247-50.204C470.13,74.592,472,66.687,472,58.571C472,24.633,447.938,0,414.786,0H219c-11.046,0-20,8.954-20,20s8.954,20,20,20h195.786C430.322,40,432,52.987,432,58.571c0,8.252-6.97,12.739-9.105,13.917C411.675,78.677,410,87.569,410,92.318C410,105.037,420.981,115,435,115h4.511c9.607,0,17.423,7.626,17.423,17c0,5.966-3.324,11.587-8.674,14.668c-0.339,0.195-0.654,0.363-0.94,0.517c-8.838,4.774-13.319,11.634-13.319,20.39c0,7.547,5.038,20.593,23.92,21.612C465.552,189.6,472,197.299,472,206c0,7.672-5.422,14.609-12.892,16.493C447.081,225.527,439,234.974,439,246c0,5.459,2.013,13.362,11.6,20.014c4.634,3.215,7.4,8.443,7.4,13.986c0,9.374-7.626,17-17,17H309.426c-30.47,0-64.184,21.642-65.52,56.607l-0.015,0.764c0,12.024,8.777,30.694,30.327,73.598c3.268,6.506,6.367,12.677,9.25,18.526c0.507,1.777,0.763,3.624,0.763,5.505c0,11.028-8.972,20-20,20c-4.982,0-9.673-1.802-13.345-5.101l-10.091-14.143L140.432,296.475C146.484,287.109,150,275.957,150,264V60c0-33.084-26.916-60-60-60H60C26.916,0,0,26.916,0,60v204c0,33.084,26.916,60,60,60h30c6.513,0,12.786-1.043,18.663-2.971l98.74,153.753l12.888,18.104l1.093,1.114c11.377,11.607,26.594,18,42.848,18c33.084,0,60-26.916,60-60c0-6.667-1.092-13.226-3.244-19.495l-0.409-1.192l-0.557-1.132c-3.143-6.397-6.502-13.085-10.059-20.166c-8.962-17.841-23.756-47.296-25.975-56.153C285.43,343.38,299.444,337,309.426,337H441c31.43,0,57-25.57,57-57c0-10.347-2.83-20.344-7.982-29.021C503.571,240.431,512,224.026,512,206z M110,264c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V264z")
                          | {{ recommendation.from.downvotes }}
                      p.reason.container
                        strong Причина:
                        | {{ recommendation.reason }}
                      p {{ recommendation.text }}
                      p.vote-buttons.container
                        button.btn.container.vote-good(@click="makeVote('recommendation', recommendation.id, true)" type="button" :class="recommendation.is_helpful === true ? 'active' : ''")
                          svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                            path(d="M452,188h-30c-6.513,0-12.786,1.043-18.663,2.971l-98.74-153.753l-12.888-18.104L290.616,18C279.239,6.392,264.022,0,247.769,0c-33.084,0-60,26.916-60,60c0,6.667,1.092,13.226,3.244,19.495l0.409,1.192l0.557,1.132c3.142,6.395,6.5,13.081,10.055,20.158c8.963,17.845,23.761,47.306,25.978,56.162C226.569,168.62,212.556,175,202.574,175H71c-31.43,0-57,25.57-57,57c0,10.347,2.83,20.344,7.982,29.021C8.429,271.569,0,287.974,0,306c0,14.156,5.172,27.793,14.563,38.398c2.471,2.791,5.164,5.293,8.038,7.487c-4.851,8.455-7.535,18.124-7.535,28.115c0,21.677,12.255,40.567,30.247,50.204C41.87,437.408,40,445.313,40,453.429C40,487.367,64.062,512,97.214,512H293c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H97.214C81.678,472,80,459.013,80,453.429c0-8.252,6.97-12.739,9.105-13.917c11.22-6.189,12.895-15.081,12.895-19.83C102,406.963,91.019,397,77,397h-4.511c-9.607,0-17.423-7.626-17.423-17c0-5.966,3.324-11.587,8.674-14.668c0.339-0.195,0.654-0.363,0.94-0.517c8.839-4.774,13.32-11.634,13.32-20.39c0-7.547-5.038-20.593-23.92-21.612C46.448,322.4,40,314.701,40,306c0-7.672,5.422-14.609,12.892-16.493C64.919,286.473,73,277.026,73,266c0-5.459-2.013-13.362-11.6-20.014C56.767,242.771,54,237.543,54,232c0-9.374,7.626-17,17-17h131.574c30.471,0,64.185-21.643,65.519-56.607l0.015-0.763c0-12.025-8.777-30.697-30.33-73.606c-3.267-6.504-6.365-12.672-9.246-18.519c-0.507-1.777-0.763-3.624-0.763-5.505c0-11.028,8.972-20,20-20c4.982,0,9.673,1.802,13.345,5.101l10.091,14.143l100.364,156.281C365.516,224.891,362,236.043,362,248v204c0,33.084,26.916,60,60,60h30c33.084,0,60-26.916,60-60V248C512,214.916,485.084,188,452,188z M472,452c0,11.028-8.972,20-20,20h-30c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V452z")
                          span Полезно
                        button.btn.container.vote-bad(@click="makeVote('recommendation', recommendation.id, false)" type="button" :class="recommendation.is_helpful === false ? 'active' : ''")
                          svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                            path(d="M512,206c0-14.156-5.172-27.793-14.563-38.398c-2.471-2.791-5.164-5.293-8.038-7.487c4.851-8.455,7.535-18.124,7.535-28.115c0-21.677-12.255-40.567-30.247-50.204C470.13,74.592,472,66.687,472,58.571C472,24.633,447.938,0,414.786,0H219c-11.046,0-20,8.954-20,20s8.954,20,20,20h195.786C430.322,40,432,52.987,432,58.571c0,8.252-6.97,12.739-9.105,13.917C411.675,78.677,410,87.569,410,92.318C410,105.037,420.981,115,435,115h4.511c9.607,0,17.423,7.626,17.423,17c0,5.966-3.324,11.587-8.674,14.668c-0.339,0.195-0.654,0.363-0.94,0.517c-8.838,4.774-13.319,11.634-13.319,20.39c0,7.547,5.038,20.593,23.92,21.612C465.552,189.6,472,197.299,472,206c0,7.672-5.422,14.609-12.892,16.493C447.081,225.527,439,234.974,439,246c0,5.459,2.013,13.362,11.6,20.014c4.634,3.215,7.4,8.443,7.4,13.986c0,9.374-7.626,17-17,17H309.426c-30.47,0-64.184,21.642-65.52,56.607l-0.015,0.764c0,12.024,8.777,30.694,30.327,73.598c3.268,6.506,6.367,12.677,9.25,18.526c0.507,1.777,0.763,3.624,0.763,5.505c0,11.028-8.972,20-20,20c-4.982,0-9.673-1.802-13.345-5.101l-10.091-14.143L140.432,296.475C146.484,287.109,150,275.957,150,264V60c0-33.084-26.916-60-60-60H60C26.916,0,0,26.916,0,60v204c0,33.084,26.916,60,60,60h30c6.513,0,12.786-1.043,18.663-2.971l98.74,153.753l12.888,18.104l1.093,1.114c11.377,11.607,26.594,18,42.848,18c33.084,0,60-26.916,60-60c0-6.667-1.092-13.226-3.244-19.495l-0.409-1.192l-0.557-1.132c-3.143-6.397-6.502-13.085-10.059-20.166c-8.962-17.841-23.756-47.296-25.975-56.153C285.43,343.38,299.444,337,309.426,337H441c31.43,0,57-25.57,57-57c0-10.347-2.83-20.344-7.982-29.021C503.571,240.431,512,224.026,512,206z M110,264c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V264z")
                          span Не полезно
                    button.btn.answer-complane(type="button", title="Пожаловаться", @click="openReportModal($event, 'recommendation', recommendation.id)")
                      svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                        path(d="M495.097,262.582l-101.479-89.955l100.67-84.508c0.046-0.039,0.093-0.078,0.139-0.118c16.084-13.754,21.739-35.467,14.408-55.32c-7.33-19.851-25.741-32.678-46.902-32.678H79.999C35.887,0.003,0,35.891,0,80.002v411.994c0,11.046,8.954,20,20,20s20-8.954,20-20V80.002c0-22.056,17.944-39.999,39.999-39.999h381.934c6.288,0,8.654,4.571,9.381,6.536c0.723,1.958,1.889,6.941-2.83,11.02l-118.338,99.34c-4.454,3.739-7.061,9.233-7.139,15.049c-0.079,5.815,2.378,11.377,6.731,15.235l118.828,105.332c4.661,4.132,3.452,9.091,2.717,11.031c-0.737,1.94-3.122,6.453-9.351,6.453H119.998c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h341.933c20.963,0,39.311-12.664,46.748-32.262C516.115,298.136,510.784,276.487,495.097,262.582z")

              ul.feedback_list(v-if="feedbackAnswers")
                li(type="button" v-for="mes_id of answers.appeal_messages_ids")
                  button.btn.feedback_question.container
                    span {{ answers.appeal_messages[mes_id].text }}
                    svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                      path(d="M506.157,132.386c-7.803-7.819-20.465-7.831-28.285-0.029l-207.73,207.299c-7.799,7.798-20.486,7.797-28.299-0.015L34.128,132.357c-7.819-7.803-20.481-7.79-28.285,0.029c-7.802,7.819-7.789,20.482,0.029,28.284l207.701,207.27c11.701,11.699,27.066,17.547,42.433,17.547c15.358,0,30.719-5.846,42.405-17.533L506.128,160.67C513.946,152.868,513.959,140.205,506.157,132.386z")
                  ul.answer_list

                    li.card.container(v-for="answer in answers.list.filter(e => e.appeal_message_id === answers.appeal_messages[mes_id].id)" @click="switchFeedbackSelection(answer.id, 'answers')" :class="answer.selected ? 'selected' : ''")
                      img(:src="answer.from.avatar", alt="Avatar")
                      .answer
                        p.usefull.container Полезность пользователя:
                          span.good.container
                            svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                              path(d="M452,188h-30c-6.513,0-12.786,1.043-18.663,2.971l-98.74-153.753l-12.888-18.104L290.616,18C279.239,6.392,264.022,0,247.769,0c-33.084,0-60,26.916-60,60c0,6.667,1.092,13.226,3.244,19.495l0.409,1.192l0.557,1.132c3.142,6.395,6.5,13.081,10.055,20.158c8.963,17.845,23.761,47.306,25.978,56.162C226.569,168.62,212.556,175,202.574,175H71c-31.43,0-57,25.57-57,57c0,10.347,2.83,20.344,7.982,29.021C8.429,271.569,0,287.974,0,306c0,14.156,5.172,27.793,14.563,38.398c2.471,2.791,5.164,5.293,8.038,7.487c-4.851,8.455-7.535,18.124-7.535,28.115c0,21.677,12.255,40.567,30.247,50.204C41.87,437.408,40,445.313,40,453.429C40,487.367,64.062,512,97.214,512H293c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H97.214C81.678,472,80,459.013,80,453.429c0-8.252,6.97-12.739,9.105-13.917c11.22-6.189,12.895-15.081,12.895-19.83C102,406.963,91.019,397,77,397h-4.511c-9.607,0-17.423-7.626-17.423-17c0-5.966,3.324-11.587,8.674-14.668c0.339-0.195,0.654-0.363,0.94-0.517c8.839-4.774,13.32-11.634,13.32-20.39c0-7.547-5.038-20.593-23.92-21.612C46.448,322.4,40,314.701,40,306c0-7.672,5.422-14.609,12.892-16.493C64.919,286.473,73,277.026,73,266c0-5.459-2.013-13.362-11.6-20.014C56.767,242.771,54,237.543,54,232c0-9.374,7.626-17,17-17h131.574c30.471,0,64.185-21.643,65.519-56.607l0.015-0.763c0-12.025-8.777-30.697-30.33-73.606c-3.267-6.504-6.365-12.672-9.246-18.519c-0.507-1.777-0.763-3.624-0.763-5.505c0-11.028,8.972-20,20-20c4.982,0,9.673,1.802,13.345,5.101l10.091,14.143l100.364,156.281C365.516,224.891,362,236.043,362,248v204c0,33.084,26.916,60,60,60h30c33.084,0,60-26.916,60-60V248C512,214.916,485.084,188,452,188z M472,452c0,11.028-8.972,20-20,20h-30c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V452z")
                            | {{ answer.from.upvotes }}
                          | /
                          span.bad.container
                            svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                              path(d="M512,206c0-14.156-5.172-27.793-14.563-38.398c-2.471-2.791-5.164-5.293-8.038-7.487c4.851-8.455,7.535-18.124,7.535-28.115c0-21.677-12.255-40.567-30.247-50.204C470.13,74.592,472,66.687,472,58.571C472,24.633,447.938,0,414.786,0H219c-11.046,0-20,8.954-20,20s8.954,20,20,20h195.786C430.322,40,432,52.987,432,58.571c0,8.252-6.97,12.739-9.105,13.917C411.675,78.677,410,87.569,410,92.318C410,105.037,420.981,115,435,115h4.511c9.607,0,17.423,7.626,17.423,17c0,5.966-3.324,11.587-8.674,14.668c-0.339,0.195-0.654,0.363-0.94,0.517c-8.838,4.774-13.319,11.634-13.319,20.39c0,7.547,5.038,20.593,23.92,21.612C465.552,189.6,472,197.299,472,206c0,7.672-5.422,14.609-12.892,16.493C447.081,225.527,439,234.974,439,246c0,5.459,2.013,13.362,11.6,20.014c4.634,3.215,7.4,8.443,7.4,13.986c0,9.374-7.626,17-17,17H309.426c-30.47,0-64.184,21.642-65.52,56.607l-0.015,0.764c0,12.024,8.777,30.694,30.327,73.598c3.268,6.506,6.367,12.677,9.25,18.526c0.507,1.777,0.763,3.624,0.763,5.505c0,11.028-8.972,20-20,20c-4.982,0-9.673-1.802-13.345-5.101l-10.091-14.143L140.432,296.475C146.484,287.109,150,275.957,150,264V60c0-33.084-26.916-60-60-60H60C26.916,0,0,26.916,0,60v204c0,33.084,26.916,60,60,60h30c6.513,0,12.786-1.043,18.663-2.971l98.74,153.753l12.888,18.104l1.093,1.114c11.377,11.607,26.594,18,42.848,18c33.084,0,60-26.916,60-60c0-6.667-1.092-13.226-3.244-19.495l-0.409-1.192l-0.557-1.132c-3.143-6.397-6.502-13.085-10.059-20.166c-8.962-17.841-23.756-47.296-25.975-56.153C285.43,343.38,299.444,337,309.426,337H441c31.43,0,57-25.57,57-57c0-10.347-2.83-20.344-7.982-29.021C503.571,240.431,512,224.026,512,206z M110,264c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V264z")
                            | {{ answer.from.downvotes }}
                        p {{ answer.text }}
                        p.vote-buttons.container
                          button.btn.container.vote-good(@click="makeVote('answer', answer.id, true)" type="button" :class="answer.is_helpful === true ? 'active' : ''")
                            svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                              path(d="M452,188h-30c-6.513,0-12.786,1.043-18.663,2.971l-98.74-153.753l-12.888-18.104L290.616,18C279.239,6.392,264.022,0,247.769,0c-33.084,0-60,26.916-60,60c0,6.667,1.092,13.226,3.244,19.495l0.409,1.192l0.557,1.132c3.142,6.395,6.5,13.081,10.055,20.158c8.963,17.845,23.761,47.306,25.978,56.162C226.569,168.62,212.556,175,202.574,175H71c-31.43,0-57,25.57-57,57c0,10.347,2.83,20.344,7.982,29.021C8.429,271.569,0,287.974,0,306c0,14.156,5.172,27.793,14.563,38.398c2.471,2.791,5.164,5.293,8.038,7.487c-4.851,8.455-7.535,18.124-7.535,28.115c0,21.677,12.255,40.567,30.247,50.204C41.87,437.408,40,445.313,40,453.429C40,487.367,64.062,512,97.214,512H293c11.046,0,20-8.954,20-20c0-11.046-8.954-20-20-20H97.214C81.678,472,80,459.013,80,453.429c0-8.252,6.97-12.739,9.105-13.917c11.22-6.189,12.895-15.081,12.895-19.83C102,406.963,91.019,397,77,397h-4.511c-9.607,0-17.423-7.626-17.423-17c0-5.966,3.324-11.587,8.674-14.668c0.339-0.195,0.654-0.363,0.94-0.517c8.839-4.774,13.32-11.634,13.32-20.39c0-7.547-5.038-20.593-23.92-21.612C46.448,322.4,40,314.701,40,306c0-7.672,5.422-14.609,12.892-16.493C64.919,286.473,73,277.026,73,266c0-5.459-2.013-13.362-11.6-20.014C56.767,242.771,54,237.543,54,232c0-9.374,7.626-17,17-17h131.574c30.471,0,64.185-21.643,65.519-56.607l0.015-0.763c0-12.025-8.777-30.697-30.33-73.606c-3.267-6.504-6.365-12.672-9.246-18.519c-0.507-1.777-0.763-3.624-0.763-5.505c0-11.028,8.972-20,20-20c4.982,0,9.673,1.802,13.345,5.101l10.091,14.143l100.364,156.281C365.516,224.891,362,236.043,362,248v204c0,33.084,26.916,60,60,60h30c33.084,0,60-26.916,60-60V248C512,214.916,485.084,188,452,188z M472,452c0,11.028-8.972,20-20,20h-30c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V452z")
                            span Полезно
                          button.btn.container.vote-bad(@click="makeVote('answer', answer.id, false)" type="button" :class="answer.is_helpful === false ? 'active' : ''")
                            svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512")
                              path(d="M512,206c0-14.156-5.172-27.793-14.563-38.398c-2.471-2.791-5.164-5.293-8.038-7.487c4.851-8.455,7.535-18.124,7.535-28.115c0-21.677-12.255-40.567-30.247-50.204C470.13,74.592,472,66.687,472,58.571C472,24.633,447.938,0,414.786,0H219c-11.046,0-20,8.954-20,20s8.954,20,20,20h195.786C430.322,40,432,52.987,432,58.571c0,8.252-6.97,12.739-9.105,13.917C411.675,78.677,410,87.569,410,92.318C410,105.037,420.981,115,435,115h4.511c9.607,0,17.423,7.626,17.423,17c0,5.966-3.324,11.587-8.674,14.668c-0.339,0.195-0.654,0.363-0.94,0.517c-8.838,4.774-13.319,11.634-13.319,20.39c0,7.547,5.038,20.593,23.92,21.612C465.552,189.6,472,197.299,472,206c0,7.672-5.422,14.609-12.892,16.493C447.081,225.527,439,234.974,439,246c0,5.459,2.013,13.362,11.6,20.014c4.634,3.215,7.4,8.443,7.4,13.986c0,9.374-7.626,17-17,17H309.426c-30.47,0-64.184,21.642-65.52,56.607l-0.015,0.764c0,12.024,8.777,30.694,30.327,73.598c3.268,6.506,6.367,12.677,9.25,18.526c0.507,1.777,0.763,3.624,0.763,5.505c0,11.028-8.972,20-20,20c-4.982,0-9.673-1.802-13.345-5.101l-10.091-14.143L140.432,296.475C146.484,287.109,150,275.957,150,264V60c0-33.084-26.916-60-60-60H60C26.916,0,0,26.916,0,60v204c0,33.084,26.916,60,60,60h30c6.513,0,12.786-1.043,18.663-2.971l98.74,153.753l12.888,18.104l1.093,1.114c11.377,11.607,26.594,18,42.848,18c33.084,0,60-26.916,60-60c0-6.667-1.092-13.226-3.244-19.495l-0.409-1.192l-0.557-1.132c-3.143-6.397-6.502-13.085-10.059-20.166c-8.962-17.841-23.756-47.296-25.975-56.153C285.43,343.38,299.444,337,309.426,337H441c31.43,0,57-25.57,57-57c0-10.347-2.83-20.344-7.982-29.021C503.571,240.431,512,224.026,512,206z M110,264c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h30c11.028,0,20,8.972,20,20V264z")
                            span Не полезно
                      button.btn.answer-complane(type="button", title="Пожаловаться", @click="openReportModal($event, 'answer', answer.id)")
                        svg(xmlns="http://www.w3.org/2000/svg", viewBox="0 0 512 512")
                          path(d="M495.097,262.582l-101.479-89.955l100.67-84.508c0.046-0.039,0.093-0.078,0.139-0.118c16.084-13.754,21.739-35.467,14.408-55.32c-7.33-19.851-25.741-32.678-46.902-32.678H79.999C35.887,0.003,0,35.891,0,80.002v411.994c0,11.046,8.954,20,20,20s20-8.954,20-20V80.002c0-22.056,17.944-39.999,39.999-39.999h381.934c6.288,0,8.654,4.571,9.381,6.536c0.723,1.958,1.889,6.941-2.83,11.02l-118.338,99.34c-4.454,3.739-7.061,9.233-7.139,15.049c-0.079,5.815,2.378,11.377,6.731,15.235l118.828,105.332c4.661,4.132,3.452,9.091,2.717,11.031c-0.737,1.94-3.122,6.453-9.351,6.453H119.998c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h341.933c20.963,0,39.311-12.664,46.748-32.262C516.115,298.136,510.784,276.487,495.097,262.582z")

          .tab_partnership(v-if="tabPartnershipActive")
            h2.partner_heading Наставник
            div.card.card_mentor
              div.card_mentor__img
                img(src='../../images/partnership/mentor.png')(alt='mentor')
              div.mentor_info
                h3.mentor_name Rami Malek
                a.mentor_link(href='#') @ramimalek
              a.mentor_bio(href="#")
                svg( xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve" fill="#ccc" width="15px" height="15px")
                  path(d="M437.019,74.981C388.667,26.629,324.38,0,256,0S123.333,26.63,74.981,74.981S0,187.62,0,256    s26.629,132.667,74.981,181.019C123.332,485.371,187.62,512,256,512s132.667-26.629,181.019-74.981    C485.371,388.667,512,324.38,512,256S485.371,123.332,437.019,74.981z M256,470.636C137.65,470.636,41.364,374.35,41.364,256    S137.65,41.364,256,41.364S470.636,137.65,470.636,256S374.35,470.636,256,470.636z")
                  path(d="M256,235.318c-11.422,0-20.682,9.26-20.682,20.682v94.127c0,11.423,9.26,20.682,20.682,20.682    c11.423,0,20.682-9.259,20.682-20.682V256C276.682,244.578,267.423,235.318,256,235.318z")
                  path(d="M270.625,147.248c-3.852-3.852-9.183-6.058-14.625-6.058c-5.442,0-10.773,2.206-14.625,6.058    c-3.852,3.851-6.058,9.183-6.058,14.625c0,5.442,2.206,10.773,6.058,14.625c3.852,3.851,9.183,6.058,14.625,6.058    c5.442,0,10.773-2.206,14.625-6.058c3.852-3.852,6.058-9.183,6.058-14.625C276.682,156.431,274.475,151.1,270.625,147.248z")
            h2.partner_heading Реферальные ссылки:

            div.card.card_ref
              div.card_ref__img
                svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill='#ccc')
                  path(d="M60,170h50c33.084,0,60-26.916,60-60V60c0-33.084-26.916-60-60-60H60C26.916,0,0,26.916,0,60v50 C0,143.084,26.916,170,60,170z M40,60c0-11.028,8.972-20,20-20h50c11.028,0,20,8.972,20,20v50c0,11.028-8.972,20-20,20H60 c-11.028,0-20-8.972-20-20V60z")
                  rect(x="400" y="355" width="40" height="40")
                  rect(x="472" y="355" width="40" height="80")
                  rect(x="360" y="395" width="40" height="40")
                  polygon(points="280,512 280,472 319,472 319,512 359,512 359,472 320,472 320,432 240,432 240,512")
                  polygon(points="440,512 440,475 472,475 472,435 400,435 400,512")
                  rect(x="65" y="65" width="40" height="40")
                  rect(x="65" y="407" width="40" height="40")
                  rect(x="200" y="356" width="40" height="76")
                  rect(x="320" y="277" width="40" height="40")
                  path(d="M110,342H60c-33.084,0-60,26.916-60,60v50c0,33.084,26.916,60,60,60h50c33.084,0,60-26.916,60-60v-50 C170,368.916,143.084,342,110,342z M130,452c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20v-50c0-11.028,8.972-20,20-20 h50c11.028,0,20,8.972,20,20V452z")
                  polygon(points="240,117 240,157 200,157 200,197 280,197 280,117")
                  rect(x="240" width="40" height="40")
                  rect(x="280" y="77" width="40" height="40")
                  path(d="M472,197h-73v40h-39v40h40v39h112v-80h-40V197z M472,276h-72v-39h72V276z")
                  rect(x="280" y="197" width="40" height="80")
                  path(d="M452,0h-50c-33.084,0-60,26.916-60,60v50c0,33.084,26.916,60,60,60h50c33.084,0,60-26.916,60-60V60 C512,26.916,485.084,0,452,0z M472,110c0,11.028-8.972,20-20,20h-50c-11.028,0-20-8.972-20-20V60c0-11.028,8.972-20,20-20h50 c11.028,0,20,8.972,20,20V110z")
                  rect(x="407" y="65" width="40" height="40")
                  rect(x="40" y="197" width="40" height="40")
                  rect(y="237" width="40" height="80")
                  polygon(points="80,277 119,277 119,317 159,317 159,277 120,277 120,237 80,237")
                  rect(x="200" y="40" width="40" height="77")
                  polygon(points="240,317 240,356 280,356 280,395 360,395 360,355 280,355 280,316 240,316 240,237 200,237 200,317")
                  rect(x="120" y="197" width="80" height="40")
              input.card_ref__text(value="ID пользователя")(disabled)
              a.card_ref__copy(@click="copyToClipboard")

            div.card.card_ref
              div.card_ref__img
                svg(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="15px" height="15px" fill="#ccc")
                  path(d="M363.273,0H148.728C66.719,0,0,66.719,0,148.728v214.544C0,445.281,66.719,512,148.728,512h214.544 c23.662,0,46.291-5.399,67.26-16.049c19.98-10.146,37.717-24.968,51.293-42.864c6.675-8.799,4.954-21.345-3.846-28.021 c-8.797-6.675-21.344-4.956-28.021,3.846C429.183,456.295,397.588,472,363.273,472H148.728C88.775,472,40,423.225,40,363.273 V148.728C40,88.775,88.775,40,148.728,40h214.544C423.225,40,472,88.775,472,148.728V343c0,11.046,8.954,20,20,20 c11.046,0,20-8.954,20-20V148.728C512,66.719,445.281,0,363.273,0z")
                  path(d="M256,118c-76.094,0-138,61.906-138,138s61.906,138,138,138s138-61.906,138-138S332.094,118,256,118z M256,354 c-54.037,0-98-43.963-98-98s43.963-98,98-98s98,43.963,98,98S310.037,354,256,354z")
                  circle(cx="396" cy="116" r="20")
              input.card_ref__text(value="Логин в Instagram")(disabled)
              a.card_ref__copy(@click="copyToClipboard")

            div.card.ref_counter__wrap
              div.ref_counter 5,943
              div.ref_counter__text Количество рефералов
              div.points_counter
                span.points_counter__text Баллов заработано:
                span.points_counter__value 485
            div.ref_levels.card
              h2.partner_heading Реферальные уровни
              div.ref_circles__wrap
                div.ref_circle-3(@click="$emit('openRefferalsSecondModal')")
                div.ref_circle-2(@click="$emit('openRefferalsMainModal')")
                  div.ref_circle-1
                    ul.ref_list
                      li
                        a(href="#")
                          span.more_refs +10к
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-2.png')
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-3.png')
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-4.png')
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-5.png')
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-6.png')
                      li
                        a(href="#")
                          img(src='../../images/partnership/ref-7.png')
                      li
                        a(href='#')
                          img(src='../../images/partnership/ref-8.png')
                    div.ref_circle-avatar
                      a(href='#')
                        img(src='../../images/partnership/user_avatar.png')


</template>

<script>
import ModalDataFilter from './modals/ModalDataFilter'

export default {
  name: 'ProfilePage',
  components : {
      ModalDataFilter
  },
  data: function () {
      return {

          sections : [
              {
                  code: 'media_rotation',
                  title: 'Посты',
                  viewBox: '0 0 824.8 1039.5',
                  path: `<path d="M140.3,1038.9a164.2,164.2,0,0,1-90.1-44.1c-22.7-21.8-36.7-45-45.6-75.9L0,903.1V136.3l4.6-15.9C21.6,61.7,63.2,20.7,123.1,3.7,135.6.2,150.3,0,411.9,0S688.1.2,700.7,3.7c30.4,8.7,51.9,20.7,72.8,40.8s36.1,44,45.6,74.8l4.6,14.9.6,273.5.5,273.4-5.2,10.8a40.7,40.7,0,0,1-32.4,22.5c-13.1,1.5-29.6-6.6-37.1-18.1l-5.7-8.8-1-271.6-1-271.5-4.7-11.5c-10.7-26.5-31.9-44.5-59-50.3-15.2-3.2-518.5-3.2-533.7,0-22.2,4.7-44.7,21.4-54.3,40.1-10.8,21.2-10.4,2.8-10.4,397s-.4,375.7,10.4,396.9c9.6,18.8,32.1,35.4,54.3,40.1,15.2,3.2,518.5,3.2,533.7,0,27-5.7,49-24.4,58.4-49.6,2.3-6,5-18.2,6.1-27.2,2.8-21.9,8.7-31.3,23.9-38.3,21-9.6,42.6-1.8,52.7,18.8,5.1,10.5,5.4,12.6,4.2,28-2.3,29.6-13.9,61.9-30.6,84.6s-43.1,43.5-67.4,53.7c-31.9,13.4-8.4,12.5-308,12.8-149.4.1-274.3-.1-277.7-.6Zm44.4-198.8c-15.2-7-21.9-18-21.9-35.7s6.7-28.7,21.9-35.7l10.6-4.9H463.7l10.6,4.9c15.2,7,21.9,18,21.9,35.7s-6.7,28.7-21.9,35.7L463.7,845H195.3Zm0-162.7c-15.2-7-21.9-18-21.9-35.7s6.7-28.7,21.9-35.7l10.6-4.9H629l10.9,5.7c8.7,4.6,11.9,7.7,16.5,16.5,7.2,13.8,7.2,23.2,0,37-4.6,8.8-7.8,11.9-16.5,16.5L629,682.4H195.3l-10.6-4.9Zm.3-147.3c-10-4.5-18.4-14.1-21.3-24.3-1.5-5.1-2-51-1.6-145.8l.6-138.3,5.7-8.8c4.1-6.2,8.8-10.2,16.3-13.7l10.6-4.9H629l10.9,5.7c8.7,4.6,11.9,7.7,16.5,16.5l5.6,10.8V364.4c0,119.1-.4,138.1-3.1,144.6-4.2,10.1-10.4,16.5-20.3,21.1-7.7,3.5-18.5,3.7-226.7,3.7s-219.1-.2-226.9-3.7Zm395.7-166V275.6H243.1V452.5H580.7Z"></path>`,
                  buy_prices : [
                      [1, 100],
                      [2, 200],
                      [4, 400],
                      [5, 500]
                  ]
              },
              {
                  code: 'rotation',
                  title: 'Ротация',
                  viewBox: '0 0 512 512',
                  path: `<path d="M503.186,326.083c-8.965-6.418-21.436-4.354-27.853,4.612l-98.4,137.447c-2.687,3.116-6.055,3.789-7.859,3.909c-1.856,0.123-5.412-0.112-8.549-3.051l-63.595-62.061c-7.89-7.7-20.53-7.546-28.23,0.345c-7.7,7.891-7.545,20.529,0.345,28.23l63.704,62.167c0.059,0.057,0.119,0.115,0.179,0.172c9.551,9.092,22.299,14.149,35.415,14.149c1.127,0,2.259-0.037,3.389-0.113c14.288-0.952,27.626-7.9,36.596-19.063c0.232-0.289,0.455-0.583,0.671-0.884l98.8-138.006C514.216,344.971,512.152,332.501,503.186,326.083z"></path><path d="M250.716,271.399c1.754,0.068,3.514,0.102,5.284,0.102c1.773,0,3.537-0.034,5.293-0.102c51.318,1.233,100.594,20.362,139.276,54.179c8.302,7.257,20.913,6.41,28.169-1.891c7.257-8.301,6.41-20.912-1.891-28.169c-26.353-23.039-56.863-40.309-89.595-51.086c33.064-24.782,54.496-64.277,54.496-108.683C391.749,60.897,330.853,0,255.999,0s-135.75,60.897-135.75,135.75c0,44.423,21.448,83.93,54.534,108.711c-30.313,9.98-58.756,25.508-83.65,45.983c-45.648,37.548-77.386,89.92-89.367,147.471c-3.755,18.033,0.744,36.555,12.34,50.815c11.54,14.191,28.651,22.329,46.947,22.329h175.983c11.026,0,19.963-8.938,19.963-19.963s-8.939-19.963-19.963-19.963H61.052c-8.522,0-13.664-4.757-15.97-7.592c-3.982-4.896-5.523-11.269-4.228-17.487C61.572,346.541,149.35,273.849,250.716,271.399z M160.177,135.751c0-52.838,42.986-95.824,95.824-95.824s95.824,42.986,95.824,95.824c0,51.215-40.386,93.173-90.983,95.703c-1.612-0.03-3.225-0.045-4.84-0.045c-1.609,0-3.217,0.016-4.823,0.046C200.572,228.933,160.177,186.971,160.177,135.751z"></path>`,
                  buy_prices : [
                      [10, 1000],
                      [30, 3000],
                      [50, 5000],
                      [150, 15000],
                      [300, 30000]
                  ]
              },
              {
                  code: 'avatar_rotation',
                  title: 'Аватары',
                  viewBox: '0 0 512 512',
                  path: `<path d="M393,332.1V80a40,40,0,0,0-40-40H159a40,40,0,0,0-40,40V432a40,40,0,0,0,40,40H353a40,40,0,0,0,40-40,20,20,0,0,1,40,0,80.1,80.1,0,0,1-80,80H159a80.1,80.1,0,0,1-80-80V80A80.1,80.1,0,0,1,159,0H353a80.1,80.1,0,0,1,80,80V332.1a20,20,0,0,1-40,0Zm-157,89a20,20,0,1,0,20-20A20,20,0,0,0,236,421.1Zm40-310a20,20,0,0,0,0-40H236a20,20,0,0,0,0,40Zm43.8,247H192.2a32.9,32.9,0,0,1-25.7-12.2,33.2,33.2,0,0,1-6.8-27.8,98.3,98.3,0,0,1,45.4-63.9,63,63,0,1,1,101.8,0,98.3,98.3,0,0,1,45.4,63.9,33.2,33.2,0,0,1-6.8,27.8A32.9,32.9,0,0,1,319.8,358.1ZM233,217.1a23,23,0,1,0,23-23A23,23,0,0,0,233,217.1Zm77.8,101a58.2,58.2,0,0,0-54.3-38h-1a58.2,58.2,0,0,0-54.3,38Z"></path>`,
                  buy_prices : [
                      [1, 100],
                      [2, 200],
                      [4, 400],
                      [5, 500]
                  ]
              }
          ],

          statistics : {
              // выбранный тип статистики
              selected_code : 'rotation',
              date_range: [
                  this.getFormatedDate(Date.now()),
                  this.getFormatedDate(Date.now())
              ],
              chute_type: 1, // 0 - с воронкой, 1 - без воронки
              // какая статистика для каждого вида секций
              'rotation' : {
                  lines : [
                      {
                          code: 'stage1_shows',
                          title: 'Всего попаданий в ротацию',
                          value: 0,
                          color: () => { return '1'; }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return line.value ? 100 : 0;
                          }
                      },
                      {
                          code: 'stage2_shows',
                          title: 'Всего попаданий во второй этап',
                          value: 0,
                          color: () => { return '4'; }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage1_shows');
                          }
                      },
                      {
                          code: 'stage3_shows',
                          title: 'Всего попаданий в третий этап',
                          value: 0,
                          color: () => { return '4'; }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage2_shows');
                          }
                      },
                      {
                          code: 'profile_opened',
                          title: 'Профиль посмотрели',
                          value: 0,
                          color: () => { return '3'; }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage3_shows');
                          }
                      },
                      {
                          code: 'followed',
                          title: 'Подписались в Instagram',
                          value: 0,
                          color: () => { return '2'; }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'profile_opened');
                          }
                      },
                      {
                          code: 'left_reason',
                          title: 'Оставили причину не подписки',
                          value: 0,
                          color: () => {
                              if (this.statistics.chute_type) {
                                  return '1';
                              } else {
                                  return 'disabled';
                              }
                          }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage1_shows');
                          }
                      },
                      {
                          code: 'left_recommendation',
                          title: 'Оставили рекомендацию',
                          value: 0,
                          color: () => {
                              if (this.statistics.chute_type) {
                                  return '1';
                              } else {
                                  return 'disabled';
                              }
                          }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage1_shows');
                          }
                      },
                      {
                          code: 'left_answer',
                          title: 'Ответили на ваше обращение',
                          value: 0,
                          color: () => {
                              if (this.statistics.chute_type) {
                                  return '1';
                              } else {
                                  return 'disabled';
                              }
                          }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage1_shows');
                          }
                      },
                      {
                          code: 'skipped',
                          title: 'Пропустили третий этап',
                          value: 0,
                          color: () => {
                              if (this.statistics.chute_type) {
                                  return '1';
                              } else {
                                  return 'disabled';
                              }
                          }, // вернуть номер цвета от 1 до 5 (от красного до зеленого)
                          percent: (line, type) => {
                              return this.getStatisticPercent(line.value, type, 'stage1_shows', 'stage1_shows');
                          }
                      }
                  ]
              },
              'media_rotation' : {
                  lines : []
              },
              'avatar_rotation' : {
                  lines : []
              }
          },

            recommendations : [],

            answers: {
                list : [],
                // список id из appeal_messages
                appeal_messages_ids : [],
                appeal_messages: {}
            },

            //loadingUserData: true, // загружается новая информация о пользователе
            loadingUserData: false,

            buttonStatisticActive: true,
            buttonFeedbackActive: false,
            buttonPartnershipActive: false,
            tabStatisticActive: true,
            tabFeedbackActive: false,
            tabPartnershipActive: false,

            feedbackTips: true,
            feedbackAnswers: false,
            feedbackSortType: 'time',
            dataFilterActive : false
      }
  },
  computed : {
      statistics_sort_title : function() {
          if (!this.statistics.selected_code) {
              return "Выберите раздел";
          } else {
              return this.sections.find(e => e.code === this.statistics.selected_code).title;
          }
      }
  },
  mounted: async function() {
      let self = this;

      self.updateStatistics('rotation');

      // загрузим данные по отзывам
      axios({
          method : 'POST',
          url : '/api/account/answers/get'
      })
      .then(response => {

          let _answers = {
              list: [],
              appeal_messages_ids: [],
              appeal_messages: {}
          };

          _answers.appeal_messages_ids = Object.keys(response.data.appeal_messages).sort(function (a, b) {
              if (a < b) {
                  return 1;
              }
              if (a > b) {
                  return -1;
              }
              return 0;
          });

          _answers.list = response.data.answers.map(e => Object.assign(e, {selected: false}));

          _answers.appeal_messages = response.data.appeal_messages;

          self.answers = _answers;

      })
      .catch(res => {

      });

      axios({
          method : 'POST',
          url : '/api/account/recommendations/get'
      })
      .then(response => {

          self.recommendations = response.data.recommendations.map(e => Object.assign(e, {selected: false}));

      })
      .catch(res => {

      });

      if (new Date().getTime() - self.$store.state._loaded_time > 100) {
          // страница загрузки не эта
          await axios({
              method : 'POST',
              url : '/api/account/info/get'
          })
          .then(response => {

              let user = response.data.result;

              self.$store.state.user = user;

          })
          .catch(res => {

          });

      }

      this.loadingUserData = false;

  },
  methods: {
    showTutorialHelper: function (substage) {

      if (!this.$store.state.tutorial.done) {
        switch (this.$store.state.tutorial.substage) {
          case 2:
            if (substage === 2) {
              window.removeAllSelectedForTutorial();
              window.selectForTutorial('.profile_avatar > .wrapper', false);
            }
            break;

          case 3:
            if (substage === 3) {
              window.removeAllSelectedForTutorial();
              window.selectForTutorial('.profile_message', false);
            }
            break;

          case 6:
            if (substage === 6) {
              window.removeAllSelectedForTutorial();
              window.selectForTutorial('.profile_energy', false);
            }
            break;

          case 7:
            if (substage === 7) {
              window.removeAllSelectedForTutorial();
              window.selectForTutorial('.shows_posts[data-code="rotation"]', false);
              setTimeout(function() {

                document.querySelector('main').scrollTop = document.querySelector('.profile_tabs .tabs').offsetTop - 300;

              }, 500);
            }
            break;

          case 8:
          case 9:
            window.removeAllSelectedForTutorial();
            window.selectForTutorial('.profile_tabs', false);

            if (substage === 8 || substage === 9) {
              setTimeout(function() {

                document.querySelector('main').scrollTop = document.querySelector('.profile_tabs .tabs').offsetTop + 300;

              }, 500);
            }
            break;

          default:
            window.removeAllSelectedForTutorial();
            break;
        }
      }

      if (!this.$store.state.tutorial.done && this.$store.state.tutorial.substage === substage) {
        return true;
      } else {
        return false;
      }
    },
    nextStage: function() {
      this.$store.commit('nextStage');

      if (this.$store.state.tutorial.substage === 9) {
        this.setFeedbackActive();
      } else if (this.$store.state.tutorial.substage === 8) {
        this.setStatisticActive();
      }

    },
    nextStep: function() {
      this.$store.commit('nextStep');
    },
    selectAllFeedback: function () {
        if (this.feedbackTips) {
            for (let i = 0; i < this.recommendations.length; i++) {
                this.recommendations[i].selected = true;
            }
        } else {
            for (let i = 0; i < this.answers.list.length; i++) {
                this.answers.list[i].selected = true;
            }
        }
    },
    makeVote: function (feedback_type, id, is_upvote) {

        if (feedback_type === 'recommendation') {

            let recommendation = this.recommendations.find(e => e.id === id);

            if (!recommendation) return;

            if (recommendation.is_helpful !== is_upvote) {
                // убрать голос
                axios({
                    method : 'POST',
                    url : '/api/account/recommendations/vote',
                    data: {
                        for : 'rotation',
                        id : id,
                        is_helpful : is_upvote
                    }
                })
                .then(response => {

                })
                .catch(res => {

                });

                recommendation.is_helpful = is_upvote;
            }

        } else {

            let answer = this.answers.list.find(e => e.id === id);

            if (!answer) return;

            if (answer.is_helpful !== is_upvote) {
                // убрать голос
                axios({
                    method : 'POST',
                    url : '/api/account/answers/vote',
                    data: {
                        for : 'rotation',
                        id : id,
                        is_helpful : is_upvote
                    }
                })
                .then(response => {

                })
                .catch(res => {

                });

                answer.is_helpful = is_upvote;
            }

        }

    },
    switchFeedbackSelection: function (id, type) {

        let feedback_element;

        if (type === 'recommendations') {
            feedback_element = this.recommendations.find(e => e.id === id);
        } else {
            feedback_element = this.answers.list.find(e => e.id === id);
        }

        if (feedback_element) {
            feedback_element.selected = !feedback_element.selected
        }

    },
    getStatisticPercent: function (value, type, if_not_chute, if_chute) {

        if (this.statistics.chute_type) {
            // воронка выключена
            let ratio_value = this.statistics.rotation.lines.find(e => e.code === if_chute).value;

            if (!ratio_value) {
                 return 0; // число от которого считаем равно 0
            }

            return getPercentDifference(ratio_value, value);
        } else {
            // воронка включена
            let ratio_value = this.statistics.rotation.lines.find(e => e.code === if_not_chute).value;

            if (!ratio_value) {
                 return 0; // число от которого считаем равно 0
            }

            return getPercentDifference(ratio_value, value);
        }

    },
    messageEdit: function ($event) {
      let button = document.getElementById('messageEdit')
      while (button.tagName !== 'BUTTON') {
        button = button.parentNode
      }
      button.previousSibling.setAttribute('contenteditable', 'true')
      button.nextSibling.classList.remove('hidden')
      button.classList.add('hidden')
      window.placeCaretAtEnd(document.getElementById('appealMessage'))
    },
    messageSave: function ($event) {
      let button = $event.target
      while (button.tagName !== 'BUTTON') {
        button = button.parentNode
      }
      button.previousSibling.previousSibling.setAttribute('contenteditable', false)
      button.previousSibling.classList.remove('hidden')
      button.classList.add('hidden')

      let message = document.getElementById('appealMessage').innerText.trim();
      let self = this;

      axios({
          method : 'POST',
          url : '/api/message/edit',
          data : {
              message : message
          }
      })
      .then(response => {

          self.$store.state.user.appeal_message = '';
          self.$store.state.user.appeal_message = message;

          this.$store.commit('nextStage');

          if (!this.$store.state.tutorial.done) {
            let elements = document.getElementsByClassName('selected_for_tutorial');

            while (elements.length) {
              elements[0].classList.remove('selected_for_tutorial')
            }
          }
      })
      .catch(res => {

      });



    },
    clickExchangeButton: function ($event) {
        if (this.$store.state.user.ref_activity_points > 0) {

            let self = this;

            let ref_points = this.$store.state.user.ref_activity_points;

            this.$store.state.user.activity_points += ref_points;
            this.$store.state.user.ref_activity_points = 0;

            axios({
                method : 'POST',
                url : '/api/referral/points/convert'
            })
            .then(response => {

                this.$store.state.user.activity_points = response.data.activity_points;

            })
            .catch(res => {

            });

        }
    },
    setStatisticActive: function ($event) {
      if (!$event || !$event.target.classList.contains('active')) {
        this.buttonStatisticActive = true
        this.buttonFeedbackActive = false
        this.buttonPartnershipActive = false
        this.tabStatisticActive = true
        this.tabFeedbackActive = false
        this.tabPartnershipActive = false
      }
    },
    setFeedbackActive: function ($event) {
      if (!$event || !$event.target.classList.contains('active')) {
        this.buttonStatisticActive = false
        this.buttonFeedbackActive = true
        this.buttonPartnershipActive = false
        this.tabStatisticActive = false
        this.tabFeedbackActive = true
        this.tabPartnershipActive = false
      }
    },
    setPartnershipActive: function ($event) {
      if (!$event || !$event.target.classList.contains('active')) {
        this.buttonStatisticActive = false
        this.buttonFeedbackActive = false
        this.buttonPartnershipActive = true
        this.tabStatisticActive = false
        this.tabFeedbackActive = false
        this.tabPartnershipActive = true
      }
    },
    setActiveTimeFilter: function ($event, add_days) {

        let buttonsList = $event.target.parentNode.childNodes;

        if ($event.target.classList.contains('active')) return;

        for (let i = 0; i < buttonsList.length; i++) {
            buttonsList[i].classList.remove('active');
        }


        $event.target.classList.add('active');

        this.statistics.date_range = [
            this.getFormatedDate(Date.now() - (add_days * 24 * 60 * 60 * 1000)),
            this.getFormatedDate(Date.now()),
        ];

        this.updateStatistics();

    },
    switchChute: function ($event) {
        // поменять отображение процентов
        if (this.statistics.chute_type) {
            this.statistics.chute_type = 0;
        } else {
            this.statistics.chute_type = 1;
        }

    },
    deleteSelected: function () {
        if (this.feedbackTips) {
            // рекомендации
            let selected_ids = this.recommendations.filter(e => e.selected === true).map(e => e.id);

            if (!selected_ids.length) return;

            axios({
                method : 'POST',
                url : '/api/account/recommendations/delete',
                data: {
                    ids : {
                        rotation : selected_ids
                    }
                }
            })
            .then(response => {

            })
            .catch(res => {

            });

            this.recommendations = this.recommendations.filter(e => selected_ids.indexOf(e.id) > -1 ? false : true);


        } else {
            // ответы
            let selected_ids = this.answers.list.filter(e => e.selected === true).map(e => e.id);

            if (!selected_ids.length) return;

            axios({
                method : 'POST',
                url : '/api/account/answers/delete',
                data: {
                    ids : {
                        rotation : selected_ids
                    }
                }
            })
            .then(response => {

            })
            .catch(res => {

            });

            this.answers.list = this.answers.list.filter(e => selected_ids.indexOf(e.id) > -1 ? false : true);
        }
    },
    setFeedbackSort: function (type) {
        this.feedbackSortType = type;
        // сотртируем список рекомендации и ответов
        this.feedbackSort();
    },
    feedbackSort: function () {

        let type = this.feedbackSortType;

        if (type === 'time') {
            // сотртируем всё по времени
            this.recommendations.sort(function (a, b) {
                if (a.created_at < b.created_at) {
                    return 1;
                }
                if (a.created_at > b.created_at) {
                    return -1;
                }
                return 0;
            });

            this.answers.list.sort(function (a, b) {
                if (a.created_at < b.created_at) {
                    return 1;
                }
                if (a.created_at > b.created_at) {
                    return -1;
                }
                return 0;
            });

        } else {
            // сотртируем всё по лайкам
            this.recommendations.sort(function (a, b) {
                if (a.from.upvotes < b.from.upvotes) {
                    return 1;
                }
                if (a.from.upvotes > b.from.upvotes) {
                    return -1;
                }
                return 0;
            });

            this.answers.list.sort(function (a, b) {
                if (a.from.upvotes < b.from.upvotes) {
                    return 1;
                }
                if (a.from.upvotes > b.from.upvotes) {
                    return -1;
                }
                return 0;
            });
        }

    },
    openDataFilter: function ($event) {
      let button = $event.target
      while (button.tagName !== 'BUTTON') {
        button = button.parentNode
      }
      button.classList.toggle('active')
      this.$emit('openDataFilter', true)
    },
    openSorting: function ($event) {
      let button = $event.target
      while (button.tagName !== 'BUTTON') {
        button = button.parentNode
      }
      button.parentNode.classList.toggle('open')
    },
    setSortingType: function ($event) {
      let button = $event.target
      while (button.tagName !== 'BUTTON') {
        button = button.parentNode
      }

      let select_code = button.getAttribute('data-code');
      button.parentNode.parentNode.parentNode.classList.toggle('open');

      if (this.statistics.selected_code === select_code) {
          return; // не поменялось ничего
      }

      this.updateStatistics(select_code);

    },
    updateStatistics: function(select_code, start, end) {
        let self = this;

        if (!select_code) {
            // сменился диапазон дат
            select_code = this.statistics.selected_code;
        } else {
            this.statistics.selected_code = null; // запустим загрузку
        }

        // делаем запрос на получение информации
        axios({
            method : 'POST',
            url : '/api/account/statistics/get',
            data : {
                for: select_code,
                start: this.statistics.date_range[0],
                end: this.statistics.date_range[1]
            }
        })
        .then(response => {

            let stats = response.data.statistics;

            for (let i = 0; i < self.statistics[select_code].lines.length; i++) {
                self.statistics[select_code].lines[i].value = stats[ self.statistics[select_code].lines[i].code ];
            }

            self.statistics.selected_code = select_code;

        })
        .catch(res => {

        });
    },
    openFeedbackTips: function () {
      this.feedbackTips = true
      this.feedbackAnswers = false
    },
    openFeedbackAnswers: function () {
      this.feedbackTips = false
      this.feedbackAnswers = true
    },
    openReportModal: function ($event, type, id) {
      this.$emit('openReportModal', {
          type : type,
          id : id
      });
    },
    changeUserProfile: function () {
        if (!this.$store.state.user.is_linked_instagram) {

            return iziToast.custom.error({
                message : "Привяжите instagram для использования данной функции"
            });

        }

      this.$emit('userProfileActive', true)
    },
    addMoreShows: function ($event) {

        let button = $event.target;

        while (true) {
            if (button.getAttribute('data-code')) break;

            button = button.parentElement;
        }

        let target_code = button.getAttribute('data-code');

        this.$emit('moreShowsModal', {
            code : target_code,
            prices : this.sections.find(e => e.code === target_code).buy_prices
        });

    },
    getFormatedDate : function(timestamp) {

        let date = new Date(timestamp);

        let day = date.getDate();
        let month = date.getMonth() + 1;
        let year = date.getFullYear();

        let formatedDate = year + '-' + ('0'.repeat( 2 - month.toString().length ) + month) + '-' + ('0'.repeat( 2 - day.toString().length ) + day);

        return formatedDate;
    },
    filterDateRange: function(result) {
        this.dataFilterActive = false;

        if (!result) return;

         if (result.status === 1) {
             // применить
             this.statistics.date_range = [
                 this.getFormatedDate(result.range[0]),
                 this.getFormatedDate(result.range[1])
             ];


             let button = document.querySelector('.filters_buttons > button.active');

             if (button) {
                 button.classList.remove('active');
             }

         } else {
             // сбросить
             this.statistics.date_range = [
                 this.getFormatedDate(Date.now()),
                 this.getFormatedDate(Date.now())
             ];

             // установим кнопку Сегодня активной
             document.querySelector('.filters_buttons > button').classList.add('active');

         }

         this.updateStatistics();
    },

    copyToClipboard : function($event) {

      let text = $event.target.parentNode.getElementsByClassName('card_ref__text')[0].value;

      const el = document.createElement('textarea');
      el.value = text;
      document.body.appendChild(el);
      el.select();
      document.execCommand('copy');
      document.body.removeChild(el);

    }
  }
}

</script>

<style scoped lang="sass">
@import "../../sass/settings.scss"
body
  background-color: black
.profile
  &_avatar
    padding: 13px 15px 15px
    text-align: center
    background: $white
    margin: -20px -16px 0
    img
      width: 85px
      height: 85px
      border-radius: 50%
      border: 3px solid $bright
      margin: 0 auto 12px
  &_nickname
    color: $dark
    font-size: 1.66667em
  &_title
    color: $grey
    text-align: center
    margin-bottom: 10px
    font-size: $text-medium
    font-weight: 600
  &_message, &_energy, &_shows, &_tabs
    padding-top: 13px
  .card
    padding: 10px 15px
    align-items: center
    p
      width: calc(100% - 37px)
      font-weight: 600
      color: $grey
      span
        color: $bright
        &.title
          color: $grey
    .btn
      width: 22px
      margin-left: 15px
      padding: 4px
      display: flex
      justify-content: center
      align-items: center
      align-self: stretch
      svg
        width: 100%
        height: auto
        path
          fill: $white
      &-reverse
        background: $grey
        border-radius: 3px
    &.message
      margin-bottom: 12px
    &.energy
      flex-wrap: nowrap
      padding-right: 30px
      position: relative
      p
        width: auto
        span.energy
          display: flex
          margin-left: auto
          align-items: center
          svg
            height: 10px
            width: auto
            path
              fill: $bright
        &.energy_personal
          margin-bottom: 16px
        &.energy_partnership
          position: relative
          button
            position: absolute
            top: 0
            right: -26px
            span
              font-size: 0
              line-height: 0
              display: block
              width: 8px
              height: 8px
              border: solid $grey
              border-width: 1px 0 0 1px
              transform: rotate(45deg)
        &.energy_button
          padding-top: 0
          padding-bottom: 0
          height: 0
          overflow: hidden
          position: absolute
          top: 54px
          left: 0
          right: 0
          box-shadow: none
          transition: height 0.3s ease-in-out, padding 0.3s ease-in-out
          &.open
            height: 59px
            padding-top: 11px
            padding-bottom: 15px
          .btn
            width: 100%
            margin: 0
            padding-top: 8px
            padding-bottom: 8px
            font-weight: 700
  .shows
    justify-content: space-between
    .card
      width: calc((100% - 40px) / 3)
      padding: 8px
      text-align: center
      .shows_title
        margin-bottom: 13px
        font-weight: 600
        font-size: $text-small
      svg
        height: 32px
        width: auto
        margin: 0 auto 12px
        path, circle
          fill: $dark
      .shows_number
        justify-content: center
        align-items: center
        flex-wrap: nowrap
        margin-right: 0
        width: 100%
        font-weight: 600
        font-size: $text-small
        span
          color: $dark
          white-space: nowrap
        svg
          height: 13px
          width: auto
          margin: 0 4px 0 0

      &:hover, &:focus
        background: $bright
        .shows_title, .shows_number span
          color: $white
        svg
          path, circle
            fill: $white
  .tabs
    padding: 0
    button.btn
      width: calc(100% / 3)
      margin: 0
      font-size: $text-small
      color: $grey
      padding: 10px 0
      &.active
        color: $white
        background: $bright
  .tabs_content
    padding-top: 13px
    .filters_buttons
      .btn
        background: $white
        border-radius: 3px
        padding: 5px 11px
        color: $grey
        font-weight: 600
        font-size: $text-small
        border: 1px solid $white
        &:not(:last-of-type)
          margin-right: 8px
        &.active
          border-color: $bright
          color: $bright
      + .filter_buttons
        margin: auto 0 auto auto
        align-items: center
        .btn
          background: $white
          border-radius: 3px
          padding: 4px
          margin-left: 8px
          border: 1px solid $white
          svg
            height: 13px
            width: auto
            display: block
            path
              fill: $grey
          &.active
            border-color: $bright
            svg path
              fill: $bright
    .filter_icons
      margin-left: auto
      align-items: center
      margin-top: auto
      margin-bottom: auto
      .btn
        margin-right: 8px
        svg
          height: 15px
          width: auto
          display: block
          path
            fill: $grey
        &.active
          svg path
            fill: $bright
  .statistic_sorting
    p
      width: auto
    .sorting_list
      margin-left: auto
      background: $white
      border-radius: 3px
      padding: 4px 7px
      color: $dark
      position: relative
      .btn
        margin: 0
        display: flex
        align-items: center
        width: 100%
        img
          margin-left: 5px
          height: 4px
          width: auto
      ul
        position: absolute
        background: $white
        left: 0
        right: 0
        padding: 0 7px
        border-radius: 3px
        li
          overflow: hidden
          margin-top: 0
          height: 0
      &.open
        ul
          padding-bottom: 4px
          li
            margin-top: 6px
            height: 15px
  .statistic_info
    padding: 15px
    .info_line
      margin-bottom: 5px
      p
        margin-bottom: 10px
        width: 100%
        align-items: center
        .title, .progress
          width: calc(100% - 38px)
          display: block
        .number, .percent
          width: 38px
          color: $dark
          display: block
          text-align: right
        .progress
          height: 6px
          width: 100%
          background: $grey-light
          position: relative
          border-radius: 3px
          &-bar
            height: 6px
            position: absolute
            border-radius: 3px
            display: block
            top: 0
            left: 0
      .progress-bar
          transition: width 0.2s ease-in-out
      p.color_1
        .progress-bar
          background: $green linear-gradient( to left, rgb(39,191,164) 0%, rgb(70,208,192) 100%)
        .percent
          color: $green
      p.color_2
        .progress-bar
          background: $limegreen linear-gradient( to left, rgb(86,171,47) 0%, rgb(168,224,99) 100%)
        .percent
          color: $limegreen
      p.color_3
        .progress-bar
          background: $yellow linear-gradient( to left, rgb(248,190,65) 0%, rgb(252,225,46) 100%)
        .percent
          color: $yellow
      p.color_4
        .progress-bar
          background: $orangeDark linear-gradient( to left, rgb(255,95,8) 0%, rgb(255,149,55) 100%)
        .percent
          color: $orangeDark
      p.color_5
        .progress-bar
          background: $red linear-gradient( to left, rgb(171,47,47) 0%, rgb(224,99,99) 100%)
        .percent
          color: $red
      p.color_disabled
        .progress-bar
          background: $grey-light
        .percent
          color: $disabled
  .statistic_filters, .statistic_sorting, .feedback_filters
    margin-bottom: 10px
    align-items: center
  .feedback_filters
    .sorting_list
      margin-left: auto
      display: flex
      .btn
        border: 1px solid $white
        line-height: 13px
        padding: 4px 6px
        border-radius: 3px
        background: $white
        margin-left: 8px
        font-size: $text-medium
        font-weight: 600
        color: $grey
        svg
          height: 13px
          width: auto
          display: block
          path
            fill: $grey
        &.active, &:hover, &:focus
          border-color: $bright
          color: $bright
          svg path
            fill: $bright
  .feedback_list
    li
      background: $middle
      border-radius: 3px
      overflow: hidden
      &:not(:last-of-type)
        margin-bottom: 10px
  .feedback_question
    width: 100%
    border-radius: 3px
    background: $white
    padding: 8px 14px
    display: flex
    justify-content: space-between
    align-items: center
    color: $dark
    svg
      height: 6px
      display: block
      path
        fill: $grey
  .answer_list
    padding: 5px
    li
      border: 1px solid $white
      box-shadow: none
      padding: 8px
      align-items: flex-start
      background: $white
      &:not(:last-of-type)
        margin-bottom: 5px
      &.selected
        border-color: $bright
      img
        width: 30px
        height: 30px
        border-radius: 50%
        margin-right: 8px
      .answer
        flex-wrap: nowrap
        p
          width: 100%
          align-items: center
          font-size: $text-small
          &.usefull
            color: $dark
          &.reason
            margin-bottom: 4px
            strong
              color: $dark
              font-weight: 600
              display: inline-block
              margin-right: 4px
          .good, .bad, .vote-good, .vote-bad
            font-size: $text-small
            align-items: center
            margin: 0 4px
            svg
              height: 8px
              width: auto
              margin-right: 4px
              display: block
          .good, .vote-good
            color: $green
            svg path
              fill: $green
          .bad, .vote-bad
            color: $red
            svg path
              fill: $red
          &.vote-buttons
            .btn
              width: auto
              margin: 4px 8px 0 0
              padding: 0
              span
                color: $grey-light
              svg path
                fill: $grey-light
            .vote-good.active
              span
                color: $green
              svg path
                fill: $green
            .vote-bad.active
              span
                color: $red
              svg path
                fill: $red
      .answer-complane
        margin-left: 8px
        display: block
        width: auto
        padding: 4px 0
        align-self: flex-start
        svg
          height: 8px
          width: auto
          display: block
          path
            fill: $grey
.loading-page
    height: 50px
.loading
    background-image: url('/images/loading-profile-media.svg')
    background-repeat: no-repeat
    background-size: 30px
    background-position: center

.tab_feedback
    .card.container.selected, .card.container:hover
        border: 1px solid $bright

.later
  width: initial
  font-size: 12px
  margin: 10px 0
</style>
<style scoped lang="scss">
  .partner_heading {
    font-size: 11px;
    color: #3a4859;
    font-weight: 600;
    margin-bottom: 12px;
  }
  .card_mentor,
  .card_ref {
    display: -webkit-flex;
    display: -moz-flex;
    display: -ms-flex;
    display: -o-flex;
    display: flex;
    -ms-align-items: center;
    align-items: center;
    position: relative;
    margin-bottom: 15px;
  }
  .mentor_link,
  .card_ref__text {
    display: block;
    font-size: 10px;
    color: #a7b7c3;
    background: none;
    border:none;
  }
  .card_ref__text {
    padding: 0px !important;
  }
  .card_mentor__img,
  .card_ref__img {
    margin-right: 15px;
    min-width: 15px;
    width: 15px;
  }
  .card_ref__img svg {
    max-width: 100%;
  }
  .mentor_bio,
  .card_ref__copy {
    position: absolute;
    top: 50%;
    right:15px;
    transform: translate(0,-50%);
  }
  .mentor_bio:hover svg{
    fill: #000
  }

  .ref_counter__wrap {
    border-radius: 4px;
    background:url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='iso-8859-1'%3F%3E%3C!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --%3E%3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve' width='15px' height='15px' fill='%23fff'%3E%3Cpath d='M234.071,471.132H60.391c-6.453,0-12.333-2.991-16.135-8.207c-3.803-5.218-4.85-11.736-2.874-17.883 c19.732-61.346,79.908-104.191,146.336-104.191c30.909,0,60.591,9.308,85.838,26.916c9.043,6.307,21.485,4.09,27.795-4.953 c6.306-9.043,4.089-21.486-4.954-27.794c-12.498-8.717-25.85-15.828-39.817-21.257c18.583-16.896,30.911-40.555,33.053-67.048 c28.177-27.448,65.111-42.488,104.704-42.488c30.909,0,60.591,9.308,85.838,26.916c9.043,6.307,21.486,4.09,27.795-4.953 c6.306-9.043,4.089-21.486-4.954-27.794c-12.498-8.717-25.85-15.828-39.817-21.257c20.499-18.638,33.386-45.506,33.386-75.328 C496.586,45.673,450.913,0,394.774,0c-56.14,0-101.812,45.673-101.812,101.813c0,29.701,12.784,56.473,33.139,75.102 c-2.785,1.072-5.55,2.212-8.295,3.42c-12.492,5.497-24.241,12.245-35.162,20.183c-15.068-37.415-51.746-63.893-94.49-63.893 c-56.14,0-101.812,45.673-101.812,101.813c0,29.614,12.71,56.316,32.96,74.938c-54.148,20.292-98.053,63.87-115.927,119.444 c-5.928,18.431-2.788,37.976,8.616,53.623c11.402,15.645,29.042,24.618,48.401,24.618h173.68 c11.026,0,19.963-8.938,19.963-19.963S245.096,471.132,234.071,471.132z M394.775,39.926c34.124,0,61.886,27.762,61.886,61.886 s-27.762,61.886-61.886,61.886c-34.124,0-61.886-27.762-61.886-61.886S360.651,39.926,394.775,39.926z M188.155,176.55 c34.124,0,61.886,27.762,61.886,61.886s-27.762,61.886-61.886,61.886s-61.886-27.762-61.886-61.886 S154.031,176.55,188.155,176.55z'/%3E%3Cpath d='M503.217,326.082c-8.965-6.418-21.436-4.354-27.853,4.612l-98.4,137.447c-2.687,3.116-6.055,3.789-7.859,3.909 c-1.857,0.127-5.463-0.114-8.555-3.057l-63.703-61.168c-7.954-7.638-20.593-7.379-28.226,0.573 c-7.637,7.952-7.38,20.59,0.572,28.226l63.767,61.228c9.55,9.091,22.298,14.149,35.414,14.149c1.127,0,2.257-0.037,3.387-0.113 c14.288-0.952,27.628-7.9,36.599-19.062c0.233-0.289,0.455-0.584,0.672-0.885l98.799-138.006 C514.247,344.97,512.183,332.5,503.217,326.082z'/%3E%3C/svg%3E%0A") no-repeat, url(../../images/partnership/ref_counter_bg.png);
    background-size: auto, cover;
    background-position: center 15px, top left;
    padding-top: 55px !important;
    padding-bottom: 25px !important;
    color: #ffffff !important;
    text-align: center;
  }

  .ref_counter__wrap p {
    color: #ffffff;
  }
  .ref_counter {
    font-size: 30px;
    font-weight: 700;
    margin-bottom: 15px;
  }
  .profile .card.ref_counter__wrap p {
  }
  .ref_counter__text {
    font-size: 10px;
    font-weight: 600;
    color: #ffffff !important;
    margin-bottom: 15px;
  }
  .points_counter__text {
    font-size: 10px;
    color: #ffffff !important;
    display: inline-block;

  }
  .points_counter__value {
    font-size: 15px;
    font-weight: 700;
    color: #ffffff !important;
    display: inline-block;
    margin-left: 5px;
  }
  .ref_circle-3 {
    border-width: 8.889px;
    border-color: rgb(124, 237, 224);
    border-style: solid;
    border-radius: 50%;
    position: absolute;
    opacity: 0.9;
    cursor: pointer;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
    width: 244.222px;
    height: 243.222px;
    margin: 0 auto;
  }
  .ref_circles__wrap {
    width: 250px;
    height: 250px;
    position: relative;
    margin: 0px auto 0;
  }
  .ref_circle-2 {
    border-width: 8.889px;
    border-color: rgb(112, 228, 215);
    border-style: solid;
    border-radius: 50%;
    position: absolute;
    left: 50%;
    top: 50%;
    opacity: 0.9;
    cursor: pointer;
    transform: translate(-50%,-50%);
    width: 197.222px;
    height: 197.222px;
    z-index: 120;
  }
  .ref_circle-1 {
    border-width: 8.889px;
    border-color: rgb(70, 208, 192);
    border-style: solid;
    border-radius: 50%;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    width: 141.222px;
    height: 140.222px;
    z-index: 121;
  }
  .ref_circle-2:hover,
  .ref_circle-3:hover {
    opacity: 1;
  }
  .ref_circle-avatar {
    border-radius: 50%;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    z-index: 140;
    cursor: pointer;
  }
  .ref_list li {
    position: absolute;
    &:nth-of-type(1) {
      top:-18px;
      left:50%;
      transform: translate(-50%,0);
    }
    &:nth-of-type(2) {
      top:0px;
      right: -0;
    }
    &:nth-of-type(3) {
      top:50%;
      right: -18px;
      transform: translate(0,-50%);
    }
    &:nth-of-type(4) {
      bottom: 0;
      right: -0;
    }
    &:nth-of-type(5) {
      bottom: -18px;
      left:50%;
      transform: translate(-50%,0);
    }
    &:nth-of-type(6) {
      bottom: 0px;
      left: -0px
    }
    &:nth-of-type(7) {
     top:50%;
     left:-18px;
     transform: translate(0,-50%);
    }
    &:nth-of-type(8) {
      top:0;
      left:0;
    }
  }
  .ref_levels {
    .partner_heading {
      text-align: center;
    }
  }
  .card_ref__copy {
    width: 15px;
    height: 15px;
    display: block;
    background: url("data:image/svg+xml,%3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512; fill:%23ccc' xml:space='preserve'%3E%3Cpath d='M366.905,108.016h-141.91c-11.048,0-20.003,8.955-20.003,20.003s8.955,20.003,20.003,20.003h141.91 c11.048,0,20.003-8.955,20.003-20.003S377.952,108.016,366.905,108.016z'/%3E%3Cpath d='M366.905,188.027h-141.91c-11.048,0-20.003,8.955-20.003,20.003s8.955,20.003,20.003,20.003h141.91 c11.047,0,20.003-8.955,20.003-20.003S377.953,188.027,366.905,188.027z'/%3E%3Cpath d='M286.004,268.039h-61.009c-11.048,0-20.003,8.955-20.003,20.003c0,11.048,8.955,20.003,20.003,20.003h61.009 c11.048,0,20.003-8.955,20.003-20.003C306.007,276.994,297.052,268.039,286.004,268.039z'/%3E%3Cpath d='M448.028,272.039c11.048,0,20.003-8.955,20.003-20.003V80.012C468.031,35.893,432.137,0,388.019,0H203.992 c-44.094,0-79.971,35.853-80.012,79.938c-44.118,0-80.012,35.893-80.012,80.012v272.039c0,44.118,35.893,80.012,80.012,80.012 h194.028c44.118,0,80.012-35.893,80.012-80.012v-0.608c39.414-4.938,70.01-38.662,70.01-79.389 c0-11.048-8.955-20.003-20.003-20.003c-11.048,0-20.003,8.955-20.003,20.003c0,22.054-17.942,40.001-39.996,40.006l-184.027,0.045 h-0.009c-10.685,0-20.73-4.16-28.285-11.715c-7.558-7.556-11.721-17.604-11.721-28.291V80.012 c0-22.059,17.947-40.006,40.006-40.006H388.02c22.059,0,40.006,17.947,40.006,40.006v172.025 C428.025,263.084,436.98,272.039,448.028,272.039z M203.992,432.047h0.02l154.002-0.038 c-0.012,22.049-17.954,39.984-40.006,39.984H123.981c-22.059,0-40.006-17.947-40.006-40.006V159.948 c0-22.059,17.947-40.006,40.006-40.006v232.094c0,21.375,8.325,41.471,23.441,56.583 C162.535,423.729,182.622,432.047,203.992,432.047z'/%3E%3C/svg%3E") center no-repeat;
  }
  .card_ref__copy:hover {
    cursor: pointer;
    background: url("data:image/svg+xml,%3Csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E%3Cpath d='M366.905,108.016h-141.91c-11.048,0-20.003,8.955-20.003,20.003s8.955,20.003,20.003,20.003h141.91 c11.048,0,20.003-8.955,20.003-20.003S377.952,108.016,366.905,108.016z'/%3E%3Cpath d='M366.905,188.027h-141.91c-11.048,0-20.003,8.955-20.003,20.003s8.955,20.003,20.003,20.003h141.91 c11.047,0,20.003-8.955,20.003-20.003S377.953,188.027,366.905,188.027z'/%3E%3Cpath d='M286.004,268.039h-61.009c-11.048,0-20.003,8.955-20.003,20.003c0,11.048,8.955,20.003,20.003,20.003h61.009 c11.048,0,20.003-8.955,20.003-20.003C306.007,276.994,297.052,268.039,286.004,268.039z'/%3E%3Cpath d='M448.028,272.039c11.048,0,20.003-8.955,20.003-20.003V80.012C468.031,35.893,432.137,0,388.019,0H203.992 c-44.094,0-79.971,35.853-80.012,79.938c-44.118,0-80.012,35.893-80.012,80.012v272.039c0,44.118,35.893,80.012,80.012,80.012 h194.028c44.118,0,80.012-35.893,80.012-80.012v-0.608c39.414-4.938,70.01-38.662,70.01-79.389 c0-11.048-8.955-20.003-20.003-20.003c-11.048,0-20.003,8.955-20.003,20.003c0,22.054-17.942,40.001-39.996,40.006l-184.027,0.045 h-0.009c-10.685,0-20.73-4.16-28.285-11.715c-7.558-7.556-11.721-17.604-11.721-28.291V80.012 c0-22.059,17.947-40.006,40.006-40.006H388.02c22.059,0,40.006,17.947,40.006,40.006v172.025 C428.025,263.084,436.98,272.039,448.028,272.039z M203.992,432.047h0.02l154.002-0.038 c-0.012,22.049-17.954,39.984-40.006,39.984H123.981c-22.059,0-40.006-17.947-40.006-40.006V159.948 c0-22.059,17.947-40.006,40.006-40.006v232.094c0,21.375,8.325,41.471,23.441,56.583 C162.535,423.729,182.622,432.047,203.992,432.047z'/%3E%3C/svg%3E") center no-repeat;
  }
  .more_refs {
    color:#ccc;
    border:1px solid #ccc;
    font-size: 10px;
    border-radius: 50%;
    background: #fff;
    display: block;
    width: 32px;
    height: 32px;
    text-align: center;
    line-height: 32px;
  }
  
</style>

